# Ngăn trình duyệt đoán MIME type, chống lại tấn công XSS.
add_header X-Content-Type-Options "nosniff" always;

# Ngăn trang web bị nhúng vào trong <iframe> trên các trang khác, chống lại tấn công Clickjacking.
add_header X-Frame-Options "SAMEORIGIN" always;

# Bật tính năng chống XSS của trình duyệt.
add_header X-XSS-Protection "1; mode=block" always;

# Kiểm soát các tài nguyên (scripts, styles, images) mà trình duyệt được phép tải.
# Đây là một chính sách rất nghiêm ngặt, bạn cần điều chỉnh cho phù hợp với ứng dụng của mình.
# Ví dụ: script-src 'self' https://trusted.cdn.com;
add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self';" always;

# Chỉ cho phép các tính năng cụ thể trên trang (ví dụ: không cho phép dùng camera, microphone).
add_header Permissions-Policy "geolocation=(), midi=(), sync-xhr=(), microphone=(), camera=(), magnetometer=(), gyroscope=(), fullscreen=(self), payment=()" always;

# Kiểm soát thông tin nào được gửi trong header Referer.
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

add_header Content-Security-Policy "
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com;
    style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com;
    font-src 'self' https://cdnjs.cloudflare.com;
    img-src 'self' data:;
" always;
