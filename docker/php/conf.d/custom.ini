; Đây là file cấu hình PHP tùy chỉnh cho môi trường Docker.
; Các giá trị ở đây sẽ ghi đè lên cấu hình mặc định của image PHP.

; --- Error Reporting Configuration ---
; E_ALL is used to ensure all errors, warnings, notices, and deprecation messages
; are reported. This is ideal for development environments to catch all potential issues.
; In production, you might consider a less verbose level like E_ALL & ~E_DEPRECATED & ~E_NOTICE.
error_reporting = E_ALL

; --- Cài đặt chung ---
date.timezone = "UTC"
memory_limit = 512M

; --- Cài đặt Upload ---
upload_max_filesize = 50M
post_max_size = 50M

; --- Cấu hình OPcache cho Production ---
; LƯU Ý: Các cài đặt dưới đây được điều chỉnh cho môi trường phát triển (development) để bật hot-reload.
; Khi triển khai lên production, hãy đổi `opcache.validate_timestamps` thành `0` và `opcache.revalidate_freq` thành `0`.
; OPcache cải thiện đáng kể hiệu năng của PHP bằng cách lưu trữ precompiled script bytecode
; trong bộ nhớ chia sẻ, qua đó loại bỏ sự cần thiết phải tải và phân tích kịch bản trên mỗi yêu cầu.
opcache.enable=1
opcache.enable_cli=1 ; Rất quan trọng cho các ứng dụng chạy dài hạn như Swoole/RoadRunner
opcache.memory_consumption=128
opcache.interned_strings_buffer=8
opcache.max_accelerated_files=10000
opcache.revalidate_freq=2 ; [DEV] Kiểm tra file thay đổi mỗi 2 giây.
opcache.validate_timestamps=1 ; [DEV] Bật kiểm tra timestamp để nhận diện file thay đổi.
opcache.save_comments=1 ; Bắt buộc đối với các framework sử dụng Annotation/Attribute
opcache.fast_shutdown=1

; --- PHP 8 JIT (Just-In-Time) Compilation ---
opcache.jit_buffer_size=128M
opcache.jit=tracing

; --- Realpath Cache Tuning ---
realpath_cache_size=4096k
realpath_cache_ttl=600

opcache.preload=/app/preload.php
