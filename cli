#!/usr/bin/env php
<?php

// cli is the entry point for all command-line operations.
// It bootstraps the application and then hands control over
// to the Console Kernel to handle the incoming commands.

// Bootstrap the application via the central bootstrap file.
// This ensures that the application, including its service container
// and environment variables, is set up correctly and consistently.
$app = require __DIR__.'/bootstrap/app.php';

// Once the application is bootstrapped, we create an instance of our
// Console Kernel. The kernel is responsible for discovering, registering,
// and executing all of the application's command-line commands.
$consoleKernel = new Core\CLI\ConsoleKernel($app);

// The `handle` method on the kernel processes the command-line arguments
// (e.g., `serve`, `migrate`) and dispatches the request to the appropriate
// command. The exit status of the command is returned.
$status = $consoleKernel->handle();

// Finally, we exit the script with the status code returned by the
// command. This is important for scripting and CI/CD pipelines,
// as a non-zero exit code typically indicates that the command failed.
exit($status);