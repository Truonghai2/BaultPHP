"use strict";(()=>{var pi=Object.create;var ct=Object.defineProperty;var yi=Object.getOwnPropertyDescriptor;var mi=Object.getOwnPropertyNames;var _i=Object.getPrototypeOf,gi=Object.prototype.hasOwnProperty;var d=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),bi=(n,t)=>{for(var e in t)ct(n,e,{get:t[e],enumerable:!0})},vi=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of mi(t))!gi.call(n,i)&&i!==e&&ct(n,i,{get:()=>t[i],enumerable:!(r=yi(t,i))||r.enumerable});return n};var lt=(n,t,e)=>(e=n!=null?pi(_i(n)):{},vi(t||!n||!n.__esModule?ct(e,"default",{value:n,enumerable:!0}):e,n));var ft=d((Rs,ht)=>{"use strict";var ce=typeof Reflect=="object"?Reflect:null,hr=ce&&typeof ce.apply=="function"?ce.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},De;ce&&typeof ce.ownKeys=="function"?De=ce.ownKeys:Object.getOwnPropertySymbols?De=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:De=function(t){return Object.getOwnPropertyNames(t)};function wi(n){console&&console.warn&&console.warn(n)}var dr=Number.isNaN||function(t){return t!==t};function S(){S.init.call(this)}ht.exports=S;ht.exports.once=Ei;S.EventEmitter=S;S.prototype._events=void 0;S.prototype._eventsCount=0;S.prototype._maxListeners=void 0;var fr=10;function Ne(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(S,"defaultMaxListeners",{enumerable:!0,get:function(){return fr},set:function(n){if(typeof n!="number"||n<0||dr(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");fr=n}});S.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};S.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||dr(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function pr(n){return n._maxListeners===void 0?S.defaultMaxListeners:n._maxListeners}S.prototype.getMaxListeners=function(){return pr(this)};S.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=s[t];if(u===void 0)return!1;if(typeof u=="function")hr(u,this,e);else for(var c=u.length,l=br(u,c),r=0;r<c;++r)hr(l[r],this,e);return!0};function yr(n,t,e,r){var i,s,o;if(Ne(e),s=n._events,s===void 0?(s=n._events=Object.create(null),n._eventsCount=0):(s.newListener!==void 0&&(n.emit("newListener",t,e.listener?e.listener:e),s=n._events),o=s[t]),o===void 0)o=s[t]=e,++n._eventsCount;else if(typeof o=="function"?o=s[t]=r?[e,o]:[o,e]:r?o.unshift(e):o.push(e),i=pr(n),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=t,a.count=o.length,wi(a)}return n}S.prototype.addListener=function(t,e){return yr(this,t,e,!1)};S.prototype.on=S.prototype.addListener;S.prototype.prependListener=function(t,e){return yr(this,t,e,!0)};function Si(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function mr(n,t,e){var r={fired:!1,wrapFn:void 0,target:n,type:t,listener:e},i=Si.bind(r);return i.listener=e,r.wrapFn=i,i}S.prototype.once=function(t,e){return Ne(e),this.on(t,mr(this,t,e)),this};S.prototype.prependOnceListener=function(t,e){return Ne(e),this.prependListener(t,mr(this,t,e)),this};S.prototype.removeListener=function(t,e){var r,i,s,o,a;if(Ne(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():xi(r,s),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,a||e)}return this};S.prototype.off=S.prototype.removeListener;S.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function _r(n,t,e){var r=n._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?Oi(i):br(i,i.length)}S.prototype.listeners=function(t){return _r(this,t,!0)};S.prototype.rawListeners=function(t){return _r(this,t,!1)};S.listenerCount=function(n,t){return typeof n.listenerCount=="function"?n.listenerCount(t):gr.call(n,t)};S.prototype.listenerCount=gr;function gr(n){var t=this._events;if(t!==void 0){var e=t[n];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}S.prototype.eventNames=function(){return this._eventsCount>0?De(this._events):[]};function br(n,t){for(var e=new Array(t),r=0;r<t;++r)e[r]=n[r];return e}function xi(n,t){for(;t+1<n.length;t++)n[t]=n[t+1];n.pop()}function Oi(n){for(var t=new Array(n.length),e=0;e<t.length;++e)t[e]=n[e].listener||n[e];return t}function Ei(n,t){return new Promise(function(e,r){function i(o){n.removeListener(t,s),r(o)}function s(){typeof n.removeListener=="function"&&n.removeListener("error",i),e([].slice.call(arguments))}vr(n,t,s,{once:!0}),t!=="error"&&Ti(n,i,{once:!0})})}function Ti(n,t,e){typeof n.on=="function"&&vr(n,"error",t,e)}function vr(n,t,e,r){if(typeof n.on=="function")r.once?n.once(t,e):n.on(t,e);else if(typeof n.addEventListener=="function")n.addEventListener(t,function i(s){r.once&&n.removeEventListener(t,i),e(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}});var mt=d((Ro,Tr)=>{"use strict";Tr.exports=Ni;function Ni(n,t){for(var e=new Array(arguments.length-1),r=0,i=2,s=!0;i<arguments.length;)e[r++]=arguments[i++];return new Promise(function(a,u){e[r]=function(l){if(s)if(s=!1,l)u(l);else{for(var b=new Array(arguments.length-1),x=0;x<b.length;)b[x++]=arguments[x];a.apply(null,b)}};try{n.apply(t||null,e)}catch(c){s&&(s=!1,u(c))}})}});var Cr=d(Pr=>{"use strict";var ze=Pr;ze.length=function(t){var e=t.length;if(!e)return 0;for(var r=0;--e%4>1&&t.charAt(e)==="=";)++r;return Math.ceil(t.length*3)/4-r};var fe=new Array(64),Rr=new Array(123);for(J=0;J<64;)Rr[fe[J]=J<26?J+65:J<52?J+71:J<62?J-4:J-59|43]=J++;var J;ze.encode=function(t,e,r){for(var i=null,s=[],o=0,a=0,u;e<r;){var c=t[e++];switch(a){case 0:s[o++]=fe[c>>2],u=(c&3)<<4,a=1;break;case 1:s[o++]=fe[u|c>>4],u=(c&15)<<2,a=2;break;case 2:s[o++]=fe[u|c>>6],s[o++]=fe[c&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=fe[u],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var kr="invalid encoding";ze.decode=function(t,e,r){for(var i=r,s=0,o,a=0;a<t.length;){var u=t.charCodeAt(a++);if(u===61&&s>1)break;if((u=Rr[u])===void 0)throw Error(kr);switch(s){case 0:o=u,s=1;break;case 1:e[r++]=o<<2|(u&48)>>4,o=u,s=2;break;case 2:e[r++]=(o&15)<<4|(u&60)>>2,o=u,s=3;break;case 3:e[r++]=(o&3)<<6|u,s=0;break}}if(s===1)throw Error(kr);return r-i};ze.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var qr=d((Co,Ar)=>{"use strict";Ar.exports=We;function We(){this._listeners={}}We.prototype.on=function(t,e,r){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:r||this}),this};We.prototype.off=function(t,e){if(t===void 0)this._listeners={};else if(e===void 0)this._listeners[t]=[];else for(var r=this._listeners[t],i=0;i<r.length;)r[i].fn===e?r.splice(i,1):++i;return this};We.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,r)}return this}});var Fr=d((Ao,jr)=>{"use strict";jr.exports=Dr(Dr);function Dr(n){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),e=new Uint8Array(t.buffer),r=e[3]===128;function i(u,c,l){t[0]=u,c[l]=e[0],c[l+1]=e[1],c[l+2]=e[2],c[l+3]=e[3]}function s(u,c,l){t[0]=u,c[l]=e[3],c[l+1]=e[2],c[l+2]=e[1],c[l+3]=e[0]}n.writeFloatLE=r?i:s,n.writeFloatBE=r?s:i;function o(u,c){return e[0]=u[c],e[1]=u[c+1],e[2]=u[c+2],e[3]=u[c+3],t[0]}function a(u,c){return e[3]=u[c],e[2]=u[c+1],e[1]=u[c+2],e[0]=u[c+3],t[0]}n.readFloatLE=r?o:a,n.readFloatBE=r?a:o}():function(){function t(r,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)r(1/i>0?0:2147483648,s,o);else if(isNaN(i))r(2143289344,s,o);else if(i>34028234663852886e22)r((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)r((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var u=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-u)*8388608)&8388607;r((a<<31|u+127<<23|c)>>>0,s,o)}}n.writeFloatLE=t.bind(null,Nr),n.writeFloatBE=t.bind(null,Lr);function e(r,i,s){var o=r(i,s),a=(o>>31)*2+1,u=o>>>23&255,c=o&8388607;return u===255?c?NaN:a*(1/0):u===0?a*1401298464324817e-60*c:a*Math.pow(2,u-150)*(c+8388608)}n.readFloatLE=e.bind(null,Ir),n.readFloatBE=e.bind(null,Br)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),e=new Uint8Array(t.buffer),r=e[7]===128;function i(u,c,l){t[0]=u,c[l]=e[0],c[l+1]=e[1],c[l+2]=e[2],c[l+3]=e[3],c[l+4]=e[4],c[l+5]=e[5],c[l+6]=e[6],c[l+7]=e[7]}function s(u,c,l){t[0]=u,c[l]=e[7],c[l+1]=e[6],c[l+2]=e[5],c[l+3]=e[4],c[l+4]=e[3],c[l+5]=e[2],c[l+6]=e[1],c[l+7]=e[0]}n.writeDoubleLE=r?i:s,n.writeDoubleBE=r?s:i;function o(u,c){return e[0]=u[c],e[1]=u[c+1],e[2]=u[c+2],e[3]=u[c+3],e[4]=u[c+4],e[5]=u[c+5],e[6]=u[c+6],e[7]=u[c+7],t[0]}function a(u,c){return e[7]=u[c],e[6]=u[c+1],e[5]=u[c+2],e[4]=u[c+3],e[3]=u[c+4],e[2]=u[c+5],e[1]=u[c+6],e[0]=u[c+7],t[0]}n.readDoubleLE=r?o:a,n.readDoubleBE=r?a:o}():function(){function t(r,i,s,o,a,u){var c=o<0?1:0;if(c&&(o=-o),o===0)r(0,a,u+i),r(1/o>0?0:2147483648,a,u+s);else if(isNaN(o))r(0,a,u+i),r(2146959360,a,u+s);else if(o>17976931348623157e292)r(0,a,u+i),r((c<<31|2146435072)>>>0,a,u+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,r(l>>>0,a,u+i),r((c<<31|l/4294967296)>>>0,a,u+s);else{var b=Math.floor(Math.log(o)/Math.LN2);b===1024&&(b=1023),l=o*Math.pow(2,-b),r(l*4503599627370496>>>0,a,u+i),r((c<<31|b+1023<<20|l*1048576&1048575)>>>0,a,u+s)}}}n.writeDoubleLE=t.bind(null,Nr,0,4),n.writeDoubleBE=t.bind(null,Lr,4,0);function e(r,i,s,o,a){var u=r(o,a+i),c=r(o,a+s),l=(c>>31)*2+1,b=c>>>20&2047,x=4294967296*(c&1048575)+u;return b===2047?x?NaN:l*(1/0):b===0?l*5e-324*x:l*Math.pow(2,b-1075)*(x+4503599627370496)}n.readDoubleLE=e.bind(null,Ir,0,4),n.readDoubleBE=e.bind(null,Br,4,0)}(),n}function Nr(n,t,e){t[e]=n&255,t[e+1]=n>>>8&255,t[e+2]=n>>>16&255,t[e+3]=n>>>24}function Lr(n,t,e){t[e]=n>>>24,t[e+1]=n>>>16&255,t[e+2]=n>>>8&255,t[e+3]=n&255}function Ir(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16|n[t+3]<<24)>>>0}function Br(n,t){return(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}});var _t=d((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var Mr=d(Jr=>{"use strict";var gt=Jr;gt.length=function(t){for(var e=0,r=0,i=0;i<t.length;++i)r=t.charCodeAt(i),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,e+=4):e+=3;return e};gt.read=function(t,e,r){var i=r-e;if(i<1)return"";for(var s=null,o=[],a=0,u;e<r;)u=t[e++],u<128?o[a++]=u:u>191&&u<224?o[a++]=(u&31)<<6|t[e++]&63:u>239&&u<365?(u=((u&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,o[a++]=55296+(u>>10),o[a++]=56320+(u&1023)):o[a++]=(u&15)<<12|(t[e++]&63)<<6|t[e++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};gt.write=function(t,e,r){for(var i=r,s,o,a=0;a<t.length;++a)s=t.charCodeAt(a),s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&((o=t.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128);return r-i}});var zr=d((Do,Ur)=>{"use strict";Ur.exports=Li;function Li(n,t,e){var r=e||8192,i=r>>>1,s=null,o=r;return function(u){if(u<1||u>i)return n(u);o+u>r&&(s=n(r),o=0);var c=t.call(s,o,o+=u);return o&7&&(o=(o|7)+1),c}}});var $r=d((No,Wr)=>{"use strict";Wr.exports=R;var we=W();function R(n,t){this.lo=n>>>0,this.hi=t>>>0}var ie=R.zero=new R(0,0);ie.toNumber=function(){return 0};ie.zzEncode=ie.zzDecode=function(){return this};ie.length=function(){return 1};var Ii=R.zeroHash="\0\0\0\0\0\0\0\0";R.fromNumber=function(t){if(t===0)return ie;var e=t<0;e&&(t=-t);var r=t>>>0,i=(t-r)/4294967296>>>0;return e&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new R(r,i)};R.from=function(t){if(typeof t=="number")return R.fromNumber(t);if(we.isString(t))if(we.Long)t=we.Long.fromString(t);else return R.fromNumber(parseInt(t,10));return t.low||t.high?new R(t.low>>>0,t.high>>>0):ie};R.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=~this.lo+1>>>0,r=~this.hi>>>0;return e||(r=r+1>>>0),-(e+r*4294967296)}return this.lo+this.hi*4294967296};R.prototype.toLong=function(t){return we.Long?new we.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var Q=String.prototype.charCodeAt;R.fromHash=function(t){return t===Ii?ie:new R((Q.call(t,0)|Q.call(t,1)<<8|Q.call(t,2)<<16|Q.call(t,3)<<24)>>>0,(Q.call(t,4)|Q.call(t,5)<<8|Q.call(t,6)<<16|Q.call(t,7)<<24)>>>0)};R.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};R.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};R.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};R.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:r<128?9:10}});var W=d(bt=>{"use strict";var h=bt;h.asPromise=mt();h.base64=Cr();h.EventEmitter=qr();h.float=Fr();h.inquire=_t();h.utf8=Mr();h.pool=zr();h.LongBits=$r();h.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);h.global=h.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||bt;h.emptyArray=Object.freeze?Object.freeze([]):[];h.emptyObject=Object.freeze?Object.freeze({}):{};h.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};h.isString=function(t){return typeof t=="string"||t instanceof String};h.isObject=function(t){return t&&typeof t=="object"};h.isset=h.isSet=function(t,e){var r=t[e];return r!=null&&t.hasOwnProperty(e)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};h.Buffer=function(){try{var n=h.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}();h._Buffer_from=null;h._Buffer_allocUnsafe=null;h.newBuffer=function(t){return typeof t=="number"?h.Buffer?h._Buffer_allocUnsafe(t):new h.Array(t):h.Buffer?h._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};h.Array=typeof Uint8Array<"u"?Uint8Array:Array;h.Long=h.global.dcodeIO&&h.global.dcodeIO.Long||h.global.Long||h.inquire("long");h.key2Re=/^true|false|0|1$/;h.key32Re=/^-?(?:0|[1-9][0-9]*)$/;h.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;h.longToHash=function(t){return t?h.LongBits.from(t).toHash():h.LongBits.zeroHash};h.longFromHash=function(t,e){var r=h.LongBits.fromHash(t);return h.Long?h.Long.fromBits(r.lo,r.hi,e):r.toNumber(!!e)};function Hr(n,t,e){for(var r=Object.keys(t),i=0;i<r.length;++i)(n[r[i]]===void 0||!e)&&(n[r[i]]=t[r[i]]);return n}h.merge=Hr;h.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Vr(n){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&Hr(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}h.newError=Vr;h.ProtocolError=Vr("ProtocolError");h.oneOfGetter=function(t){for(var e={},r=0;r<t.length;++r)e[t[r]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(e[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};h.oneOfSetter=function(t){return function(e){for(var r=0;r<t.length;++r)t[r]!==e&&delete this[t[r]]}};h.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};h._configure=function(){var n=h.Buffer;if(!n){h._Buffer_from=h._Buffer_allocUnsafe=null;return}h._Buffer_from=n.from!==Uint8Array.from&&n.from||function(e,r){return new n(e,r)},h._Buffer_allocUnsafe=n.allocUnsafe||function(e){return new n(e)}}});var He=d((Io,Xr)=>{"use strict";Xr.exports=_;var L=W(),vt,$e=L.LongBits,Gr=L.base64,Kr=L.utf8;function Se(n,t,e){this.fn=n,this.len=t,this.next=void 0,this.val=e}function St(){}function Bi(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function _(){this.len=0,this.head=new Se(St,0,0),this.tail=this.head,this.states=null}var Zr=function(){return L.Buffer?function(){return(_.create=function(){return new vt})()}:function(){return new _}};_.create=Zr();_.alloc=function(t){return new L.Array(t)};L.Array!==Array&&(_.alloc=L.pool(_.alloc,L.Array.prototype.subarray));_.prototype._push=function(t,e,r){return this.tail=this.tail.next=new Se(t,e,r),this.len+=e,this};function xt(n,t,e){t[e]=n&255}function ji(n,t,e){for(;n>127;)t[e++]=n&127|128,n>>>=7;t[e]=n}function Ot(n,t){this.len=n,this.next=void 0,this.val=t}Ot.prototype=Object.create(Se.prototype);Ot.prototype.fn=ji;_.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Ot((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};_.prototype.int32=function(t){return t<0?this._push(Et,10,$e.fromNumber(t)):this.uint32(t)};_.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Et(n,t,e){for(;n.hi;)t[e++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)t[e++]=n.lo&127|128,n.lo=n.lo>>>7;t[e++]=n.lo}_.prototype.uint64=function(t){var e=$e.from(t);return this._push(Et,e.length(),e)};_.prototype.int64=_.prototype.uint64;_.prototype.sint64=function(t){var e=$e.from(t).zzEncode();return this._push(Et,e.length(),e)};_.prototype.bool=function(t){return this._push(xt,1,t?1:0)};function wt(n,t,e){t[e]=n&255,t[e+1]=n>>>8&255,t[e+2]=n>>>16&255,t[e+3]=n>>>24}_.prototype.fixed32=function(t){return this._push(wt,4,t>>>0)};_.prototype.sfixed32=_.prototype.fixed32;_.prototype.fixed64=function(t){var e=$e.from(t);return this._push(wt,4,e.lo)._push(wt,4,e.hi)};_.prototype.sfixed64=_.prototype.fixed64;_.prototype.float=function(t){return this._push(L.float.writeFloatLE,4,t)};_.prototype.double=function(t){return this._push(L.float.writeDoubleLE,8,t)};var Fi=L.Array.prototype.set?function(t,e,r){e.set(t,r)}:function(t,e,r){for(var i=0;i<t.length;++i)e[r+i]=t[i]};_.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(xt,1,0);if(L.isString(t)){var r=_.alloc(e=Gr.length(t));Gr.decode(t,r,0),t=r}return this.uint32(e)._push(Fi,e,t)};_.prototype.string=function(t){var e=Kr.length(t);return e?this.uint32(e)._push(Kr.write,e,t):this._push(xt,1,0)};_.prototype.fork=function(){return this.states=new Bi(this),this.head=this.tail=new Se(St,0,0),this.len=0,this};_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Se(St,0,0),this.len=0),this};_.prototype.ldelim=function(){var t=this.head,e=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=t.next,this.tail=e,this.len+=r),this};_.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),r=0;t;)t.fn(t.val,e,r),r+=t.len,t=t.next;return e};_._configure=function(n){vt=n,_.create=Zr(),vt._configure()}});var en=d((Bo,Yr)=>{"use strict";Yr.exports=$;var Qr=He();($.prototype=Object.create(Qr.prototype)).constructor=$;var Y=W();function $(){Qr.call(this)}$._configure=function(){$.alloc=Y._Buffer_allocUnsafe,$.writeBytesBuffer=Y.Buffer&&Y.Buffer.prototype instanceof Uint8Array&&Y.Buffer.prototype.set.name==="set"?function(t,e,r){e.set(t,r)}:function(t,e,r){if(t.copy)t.copy(e,r,0,t.length);else for(var i=0;i<t.length;)e[r++]=t[i++]}};$.prototype.bytes=function(t){Y.isString(t)&&(t=Y._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push($.writeBytesBuffer,e,t),this};function Ji(n,t,e){n.length<40?Y.utf8.write(n,t,e):t.utf8Write?t.utf8Write(n,e):t.write(n,e)}$.prototype.string=function(t){var e=Y.Buffer.byteLength(t);return this.uint32(e),e&&this._push(Ji,e,t),this};$._configure()});var Ge=d((jo,on)=>{"use strict";on.exports=E;var M=W(),kt,nn=M.LongBits,Mi=M.utf8;function U(n,t){return RangeError("index out of range: "+n.pos+" + "+(t||1)+" > "+n.len)}function E(n){this.buf=n,this.pos=0,this.len=n.length}var tn=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new E(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new E(t);throw Error("illegal buffer")},sn=function(){return M.Buffer?function(e){return(E.create=function(i){return M.Buffer.isBuffer(i)?new kt(i):tn(i)})(e)}:tn};E.create=sn();E.prototype._slice=M.Array.prototype.subarray||M.Array.prototype.slice;E.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,U(this,10);return t}}();E.prototype.int32=function(){return this.uint32()|0};E.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function Tt(){var n=new nn(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw U(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,n}if(this.len-this.pos>4){for(;t<5;++t)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;t<5;++t){if(this.pos>=this.len)throw U(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}E.prototype.bool=function(){return this.uint32()!==0};function Ve(n,t){return(n[t-4]|n[t-3]<<8|n[t-2]<<16|n[t-1]<<24)>>>0}E.prototype.fixed32=function(){if(this.pos+4>this.len)throw U(this,4);return Ve(this.buf,this.pos+=4)};E.prototype.sfixed32=function(){if(this.pos+4>this.len)throw U(this,4);return Ve(this.buf,this.pos+=4)|0};function rn(){if(this.pos+8>this.len)throw U(this,8);return new nn(Ve(this.buf,this.pos+=4),Ve(this.buf,this.pos+=4))}E.prototype.float=function(){if(this.pos+4>this.len)throw U(this,4);var t=M.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};E.prototype.double=function(){if(this.pos+8>this.len)throw U(this,4);var t=M.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};E.prototype.bytes=function(){var t=this.uint32(),e=this.pos,r=this.pos+t;if(r>this.len)throw U(this,t);if(this.pos+=t,Array.isArray(this.buf))return this.buf.slice(e,r);if(e===r){var i=M.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,e,r)};E.prototype.string=function(){var t=this.bytes();return Mi.read(t,0,t.length)};E.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw U(this,t);this.pos+=t}else do if(this.pos>=this.len)throw U(this);while(this.buf[this.pos++]&128);return this};E.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};E._configure=function(n){kt=n,E.create=sn(),kt._configure();var t=M.Long?"toLong":"toNumber";M.merge(E.prototype,{int64:function(){return Tt.call(this)[t](!1)},uint64:function(){return Tt.call(this)[t](!0)},sint64:function(){return Tt.call(this).zzDecode()[t](!1)},fixed64:function(){return rn.call(this)[t](!0)},sfixed64:function(){return rn.call(this)[t](!1)}})}});var ln=d((Fo,cn)=>{"use strict";cn.exports=se;var un=Ge();(se.prototype=Object.create(un.prototype)).constructor=se;var an=W();function se(n){un.call(this,n)}se._configure=function(){an.Buffer&&(se.prototype._slice=an.Buffer.prototype.slice)};se.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};se._configure()});var fn=d((Jo,hn)=>{"use strict";hn.exports=xe;var Rt=W();(xe.prototype=Object.create(Rt.EventEmitter.prototype)).constructor=xe;function xe(n,t,e){if(typeof n!="function")throw TypeError("rpcImpl must be a function");Rt.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!t,this.responseDelimited=!!e}xe.prototype.rpcCall=function n(t,e,r,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return Rt.asPromise(n,o,t,e,r,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(t,e[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(u,c){if(u)return o.emit("error",u,t),s(u);if(c===null){o.end(!0);return}if(!(c instanceof r))try{c=r[o.responseDelimited?"decodeDelimited":"decode"](c)}catch(l){return o.emit("error",l,t),s(l)}return o.emit("data",c,t),s(null,c)})}catch(a){o.emit("error",a,t),setTimeout(function(){s(a)},0);return}};xe.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Pt=d(dn=>{"use strict";var Ui=dn;Ui.Service=fn()});var Ct=d((Uo,pn)=>{"use strict";pn.exports={}});var _n=d(mn=>{"use strict";var A=mn;A.build="minimal";A.Writer=He();A.BufferWriter=en();A.Reader=Ge();A.BufferReader=ln();A.util=W();A.rpc=Pt();A.roots=Ct();A.configure=yn;function yn(){A.util._configure(),A.Writer._configure(A.BufferWriter),A.Reader._configure(A.BufferReader)}yn()});var bn=d((Wo,gn)=>{"use strict";gn.exports=At;function At(n,t){typeof n=="string"&&(t=n,n=void 0);var e=[];function r(s){if(typeof s!="string"){var o=i();if(At.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),u=new Array(a.length+1),c=new Array(a.length),l=0;l<a.length;)u[l]=a[l],c[l]=s[a[l++]];return u[l]=o,Function.apply(null,u).apply(null,c)}return Function(o)()}for(var b=new Array(arguments.length-1),x=0;x<b.length;)b[x]=arguments[++x];if(x=0,s=s.replace(/%([%dfijs])/g,function(f,y){var v=b[x++];switch(y){case"d":case"f":return String(Number(v));case"i":return String(Math.floor(v));case"j":return JSON.stringify(v);case"s":return String(v)}return"%"}),x!==b.length)throw Error("parameter count mismatch");return e.push(s),r}function i(s){return"function "+(s||t||"")+"("+(n&&n.join(",")||"")+`){
  `+e.join(`
  `)+`
}`}return r.toString=i,r}At.verbose=!1});var wn=d(($o,vn)=>{"use strict";vn.exports=Oe;var zi=mt(),Wi=_t(),qt=Wi("fs");function Oe(n,t,e){return typeof t=="function"?(e=t,t={}):t||(t={}),e?!t.xhr&&qt&&qt.readFile?qt.readFile(n,function(i,s){return i&&typeof XMLHttpRequest<"u"?Oe.xhr(n,t,e):i?e(i):e(null,t.binary?s:s.toString("utf8"))}):Oe.xhr(n,t,e):zi(Oe,this,n,t)}Oe.xhr=function(t,e,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return r(Error("status "+i.status));if(e.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return r(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return r(null,i.responseText)}},e.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",t),i.send()}});var On=d(xn=>{"use strict";var Nt=xn,Sn=Nt.isAbsolute=function(t){return/^(?:\/|\w+:)/.test(t)},Dt=Nt.normalize=function(t){t=t.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var e=t.split("/"),r=Sn(t),i="";r&&(i=e.shift()+"/");for(var s=0;s<e.length;)e[s]===".."?s>0&&e[s-1]!==".."?e.splice(--s,2):r?e.splice(s,1):++s:e[s]==="."?e.splice(s,1):++s;return i+e.join("/")};Nt.resolve=function(t,e,r){return r||(e=Dt(e)),Sn(e)?e:(r||(t=Dt(t)),(t=t.replace(/(?:\/|^)[^/]+$/,"")).length?Dt(t+"/"+e):e)}});var de=d(En=>{"use strict";var Ee=En,$i=P(),Hi=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Te(n,t){var e=0,r={};for(t|=0;e<n.length;)r[Hi[e+t]]=n[e++];return r}Ee.basic=Te([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Ee.defaults=Te([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",$i.emptyArray,null]);Ee.long=Te([0,0,0,1,1],7);Ee.mapKey=Te([0,0,0,5,5,0,0,0,1,1,0,2],2);Ee.packed=Te([1,5,0,0,0,5,5,0,0,0,1,1,0])});var oe=d((Go,Rn)=>{"use strict";Rn.exports=I;var Ke=ae();((I.prototype=Object.create(Ke.prototype)).constructor=I).className="Field";var Tn=H(),kn=de(),k=P(),Lt,Vi=/^required|optional|repeated$/;I.fromJSON=function(t,e){return new I(t,e.id,e.type,e.rule,e.extend,e.options,e.comment)};function I(n,t,e,r,i,s,o){if(k.isObject(r)?(o=i,s=r,r=i=void 0):k.isObject(i)&&(o=s,s=i,i=void 0),Ke.call(this,n,s),!k.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!k.isString(e))throw TypeError("type must be a string");if(r!==void 0&&!Vi.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!k.isString(i))throw TypeError("extend must be a string");r==="proto3_optional"&&(r="optional"),this.rule=r&&r!=="optional"?r:void 0,this.type=e,this.id=t,this.extend=i||void 0,this.required=r==="required",this.optional=!this.required,this.repeated=r==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=k.Long?kn.long[e]!==void 0:!1,this.bytes=e==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(I.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});I.prototype.setOption=function(t,e,r){return t==="packed"&&(this._packed=null),Ke.prototype.setOption.call(this,t,e,r)};I.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return k.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",e?this.comment:void 0])};I.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=kn.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Lt?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Tn&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Tn))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=k.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var t;k.base64.test(this.typeDefault)?k.base64.decode(this.typeDefault,t=k.newBuffer(k.base64.length(this.typeDefault)),0):k.utf8.write(this.typeDefault,t=k.newBuffer(k.utf8.length(this.typeDefault)),0),this.typeDefault=t}return this.map?this.defaultValue=k.emptyObject:this.repeated?this.defaultValue=k.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Lt&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Ke.prototype.resolve.call(this)};I.d=function(t,e,r,i){return typeof e=="function"?e=k.decorateType(e).name:e&&typeof e=="object"&&(e=k.decorateEnum(e).name),function(o,a){k.decorateType(o.constructor).add(new I(a,t,e,r,{default:i}))}};I._configure=function(t){Lt=t}});var ke=d((Ko,An)=>{"use strict";An.exports=B;var Xe=ae();((B.prototype=Object.create(Xe.prototype)).constructor=B).className="OneOf";var Pn=oe(),Ze=P();function B(n,t,e,r){if(Array.isArray(t)||(e=t,t=void 0),Xe.call(this,n,e),!(t===void 0||Array.isArray(t)))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=r}B.fromJSON=function(t,e){return new B(t,e.oneof,e.options,e.comment)};B.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return Ze.toObject(["options",this.options,"oneof",this.oneof,"comment",e?this.comment:void 0])};function Cn(n){if(n.parent)for(var t=0;t<n.fieldsArray.length;++t)n.fieldsArray[t].parent||n.parent.add(n.fieldsArray[t])}B.prototype.add=function(t){if(!(t instanceof Pn))throw TypeError("field must be a Field");return t.parent&&t.parent!==this.parent&&t.parent.remove(t),this.oneof.push(t.name),this.fieldsArray.push(t),t.partOf=this,Cn(this),this};B.prototype.remove=function(t){if(!(t instanceof Pn))throw TypeError("field must be a Field");var e=this.fieldsArray.indexOf(t);if(e<0)throw Error(t+" is not a member of "+this);return this.fieldsArray.splice(e,1),e=this.oneof.indexOf(t.name),e>-1&&this.oneof.splice(e,1),t.partOf=null,this};B.prototype.onAdd=function(t){Xe.prototype.onAdd.call(this,t);for(var e=this,r=0;r<this.oneof.length;++r){var i=t.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=e,e.fieldsArray.push(i))}Cn(this)};B.prototype.onRemove=function(t){for(var e=0,r;e<this.fieldsArray.length;++e)(r=this.fieldsArray[e]).parent&&r.parent.remove(r);Xe.prototype.onRemove.call(this,t)};B.d=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;)t[e]=arguments[e++];return function(i,s){Ze.decorateType(i.constructor).add(new B(s,t)),Object.defineProperty(i,s,{get:Ze.oneOfGetter(t),set:Ze.oneOfSetter(t)})}}});var me=d((Zo,Ln)=>{"use strict";Ln.exports=g;var It=ae();((g.prototype=Object.create(It.prototype)).constructor=g).className="Namespace";var qn=oe(),Qe=P(),Gi=ke(),pe,Re,ye;g.fromJSON=function(t,e){return new g(t,e.options).addJSON(e.nested)};function Dn(n,t){if(n&&n.length){for(var e={},r=0;r<n.length;++r)e[n[r].name]=n[r].toJSON(t);return e}}g.arrayToJSON=Dn;g.isReservedId=function(t,e){if(t){for(var r=0;r<t.length;++r)if(typeof t[r]!="string"&&t[r][0]<=e&&t[r][1]>e)return!0}return!1};g.isReservedName=function(t,e){if(t){for(var r=0;r<t.length;++r)if(t[r]===e)return!0}return!1};function g(n,t){It.call(this,n,t),this.nested=void 0,this._nestedArray=null}function Nn(n){return n._nestedArray=null,n}Object.defineProperty(g.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Qe.toArray(this.nested))}});g.prototype.toJSON=function(t){return Qe.toObject(["options",this.options,"nested",Dn(this.nestedArray,t)])};g.prototype.addJSON=function(t){var e=this;if(t)for(var r=Object.keys(t),i=0,s;i<r.length;++i)s=t[r[i]],e.add((s.fields!==void 0?pe.fromJSON:s.values!==void 0?ye.fromJSON:s.methods!==void 0?Re.fromJSON:s.id!==void 0?qn.fromJSON:g.fromJSON)(r[i],s));return this};g.prototype.get=function(t){return this.nested&&this.nested[t]||null};g.prototype.getEnum=function(t){if(this.nested&&this.nested[t]instanceof ye)return this.nested[t].values;throw Error("no such enum: "+t)};g.prototype.add=function(t){if(!(t instanceof qn&&t.extend!==void 0||t instanceof pe||t instanceof Gi||t instanceof ye||t instanceof Re||t instanceof g))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var e=this.get(t.name);if(e)if(e instanceof g&&t instanceof g&&!(e instanceof pe||e instanceof Re)){for(var r=e.nestedArray,i=0;i<r.length;++i)t.add(r[i]);this.remove(e),this.nested||(this.nested={}),t.setOptions(e.options,!0)}else throw Error("duplicate name '"+t.name+"' in "+this)}return this.nested[t.name]=t,t.onAdd(this),Nn(this)};g.prototype.remove=function(t){if(!(t instanceof It))throw TypeError("object must be a ReflectionObject");if(t.parent!==this)throw Error(t+" is not a member of "+this);return delete this.nested[t.name],Object.keys(this.nested).length||(this.nested=void 0),t.onRemove(this),Nn(this)};g.prototype.define=function(t,e){if(Qe.isString(t))t=t.split(".");else if(!Array.isArray(t))throw TypeError("illegal path");if(t&&t.length&&t[0]==="")throw Error("path must be relative");for(var r=this;t.length>0;){var i=t.shift();if(r.nested&&r.nested[i]){if(r=r.nested[i],!(r instanceof g))throw Error("path conflicts with non-namespace objects")}else r.add(r=new g(i))}return e&&r.addJSON(e),r};g.prototype.resolveAll=function(){for(var t=this.nestedArray,e=0;e<t.length;)t[e]instanceof g?t[e++].resolveAll():t[e++].resolve();return this.resolve()};g.prototype.lookup=function(t,e,r){if(typeof e=="boolean"?(r=e,e=void 0):e&&!Array.isArray(e)&&(e=[e]),Qe.isString(t)&&t.length){if(t===".")return this.root;t=t.split(".")}else if(!t.length)return this;if(t[0]==="")return this.root.lookup(t.slice(1),e);var i=this.get(t[0]);if(i){if(t.length===1){if(!e||e.indexOf(i.constructor)>-1)return i}else if(i instanceof g&&(i=i.lookup(t.slice(1),e,!0)))return i}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof g&&(i=this._nestedArray[s].lookup(t,e,!0)))return i;return this.parent===null||r?null:this.parent.lookup(t,e)};g.prototype.lookupType=function(t){var e=this.lookup(t,[pe]);if(!e)throw Error("no such type: "+t);return e};g.prototype.lookupEnum=function(t){var e=this.lookup(t,[ye]);if(!e)throw Error("no such Enum '"+t+"' in "+this);return e};g.prototype.lookupTypeOrEnum=function(t){var e=this.lookup(t,[pe,ye]);if(!e)throw Error("no such Type or Enum '"+t+"' in "+this);return e};g.prototype.lookupService=function(t){var e=this.lookup(t,[Re]);if(!e)throw Error("no such Service '"+t+"' in "+this);return e};g._configure=function(n,t,e){pe=n,Re=t,ye=e}});var jt=d((Xo,In)=>{"use strict";In.exports=Z;var Bt=oe();((Z.prototype=Object.create(Bt.prototype)).constructor=Z).className="MapField";var Ki=de(),Pe=P();function Z(n,t,e,r,i,s){if(Bt.call(this,n,t,r,void 0,void 0,i,s),!Pe.isString(e))throw TypeError("keyType must be a string");this.keyType=e,this.resolvedKeyType=null,this.map=!0}Z.fromJSON=function(t,e){return new Z(t,e.id,e.keyType,e.type,e.options,e.comment)};Z.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return Pe.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",e?this.comment:void 0])};Z.prototype.resolve=function(){if(this.resolved)return this;if(Ki.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return Bt.prototype.resolve.call(this)};Z.d=function(t,e,r){return typeof r=="function"?r=Pe.decorateType(r).name:r&&typeof r=="object"&&(r=Pe.decorateEnum(r).name),function(s,o){Pe.decorateType(s.constructor).add(new Z(o,t,e,r))}}});var Jt=d((Qo,Bn)=>{"use strict";Bn.exports=ue;var Ft=ae();((ue.prototype=Object.create(Ft.prototype)).constructor=ue).className="Method";var _e=P();function ue(n,t,e,r,i,s,o,a,u){if(_e.isObject(i)?(o=i,i=s=void 0):_e.isObject(s)&&(o=s,s=void 0),!(t===void 0||_e.isString(t)))throw TypeError("type must be a string");if(!_e.isString(e))throw TypeError("requestType must be a string");if(!_e.isString(r))throw TypeError("responseType must be a string");Ft.call(this,n,o),this.type=t||"rpc",this.requestType=e,this.requestStream=i?!0:void 0,this.responseType=r,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=u}ue.fromJSON=function(t,e){return new ue(t,e.type,e.requestType,e.responseType,e.requestStream,e.responseStream,e.options,e.comment,e.parsedOptions)};ue.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return _e.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",e?this.comment:void 0,"parsedOptions",this.parsedOptions])};ue.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),Ft.prototype.resolve.call(this))}});var Ut=d((Yo,Fn)=>{"use strict";Fn.exports=j;var ee=me();((j.prototype=Object.create(ee.prototype)).constructor=j).className="Service";var Mt=Jt(),Ce=P(),Zi=Pt();function j(n,t){ee.call(this,n,t),this.methods={},this._methodsArray=null}j.fromJSON=function(t,e){var r=new j(t,e.options);if(e.methods)for(var i=Object.keys(e.methods),s=0;s<i.length;++s)r.add(Mt.fromJSON(i[s],e.methods[i[s]]));return e.nested&&r.addJSON(e.nested),r.comment=e.comment,r};j.prototype.toJSON=function(t){var e=ee.prototype.toJSON.call(this,t),r=t?!!t.keepComments:!1;return Ce.toObject(["options",e&&e.options||void 0,"methods",ee.arrayToJSON(this.methodsArray,t)||{},"nested",e&&e.nested||void 0,"comment",r?this.comment:void 0])};Object.defineProperty(j.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Ce.toArray(this.methods))}});function jn(n){return n._methodsArray=null,n}j.prototype.get=function(t){return this.methods[t]||ee.prototype.get.call(this,t)};j.prototype.resolveAll=function(){for(var t=this.methodsArray,e=0;e<t.length;++e)t[e].resolve();return ee.prototype.resolve.call(this)};j.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);return t instanceof Mt?(this.methods[t.name]=t,t.parent=this,jn(this)):ee.prototype.add.call(this,t)};j.prototype.remove=function(t){if(t instanceof Mt){if(this.methods[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.methods[t.name],t.parent=null,jn(this)}return ee.prototype.remove.call(this,t)};j.prototype.create=function(t,e,r){for(var i=new Zi.Service(t,e,r),s=0,o;s<this.methodsArray.length;++s){var a=Ce.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=Ce.codegen(["r","c"],Ce.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var Ye=d((ea,Jn)=>{"use strict";Jn.exports=V;var Xi=W();function V(n){if(n)for(var t=Object.keys(n),e=0;e<t.length;++e)this[t[e]]=n[t[e]]}V.create=function(t){return this.$type.create(t)};V.encode=function(t,e){return this.$type.encode(t,e)};V.encodeDelimited=function(t,e){return this.$type.encodeDelimited(t,e)};V.decode=function(t){return this.$type.decode(t)};V.decodeDelimited=function(t){return this.$type.decodeDelimited(t)};V.verify=function(t){return this.$type.verify(t)};V.fromObject=function(t){return this.$type.fromObject(t)};V.toObject=function(t,e){return this.$type.toObject(t,e)};V.prototype.toJSON=function(){return this.$type.toObject(this,Xi.toJSONOptions)}});var zt=d((ta,Un)=>{"use strict";Un.exports=es;var Qi=H(),X=de(),Mn=P();function Yi(n){return"missing required '"+n.name+"'"}function es(n){var t=Mn.codegen(["r","l"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");n.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var e=0;e<n.fieldsArray.length;++e){var r=n._fieldsArray[e].resolve(),i=r.resolvedType instanceof Qi?"int32":r.type,s="m"+Mn.safeProp(r.name);t("case %i: {",r.id),r.map?(t("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),X.defaults[r.keyType]!==void 0?t("k=%j",X.defaults[r.keyType]):t("k=null"),X.defaults[i]!==void 0?t("value=%j",X.defaults[i]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",r.keyType)("case 2:"),X.basic[i]===void 0?t("value=types[%i].decode(r,r.uint32())",e):t("value=r.%s()",i),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),X.long[r.keyType]!==void 0?t('%s[typeof k==="object"?util.longToHash(k):k]=value',s):t("%s[k]=value",s)):r.repeated?(t("if(!(%s&&%s.length))",s,s)("%s=[]",s),X.packed[i]!==void 0&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),X.basic[i]===void 0?t(r.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,e):t("%s.push(r.%s())",s,i)):X.basic[i]===void 0?t(r.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,e):t("%s=r.%s()",s,i),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),e=0;e<n._fieldsArray.length;++e){var o=n._fieldsArray[e];o.required&&t("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",Yi(o))}return t("return m")}});var Ht=d((ra,zn)=>{"use strict";zn.exports=ns;var ts=H(),Wt=P();function F(n,t){return n.name+": "+t+(n.repeated&&t!=="array"?"[]":n.map&&t!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function $t(n,t,e,r){if(t.resolvedType)if(t.resolvedType instanceof ts){n("switch(%s){",r)("default:")("return%j",F(t,"enum value"));for(var i=Object.keys(t.resolvedType.values),s=0;s<i.length;++s)n("case %i:",t.resolvedType.values[i[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",e,r)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",r)("return%j",F(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",F(t,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',r)("return%j",F(t,"number"));break;case"bool":n('if(typeof %s!=="boolean")',r)("return%j",F(t,"boolean"));break;case"string":n("if(!util.isString(%s))",r)("return%j",F(t,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",F(t,"buffer"));break}return n}function rs(n,t,e){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",e)("return%j",F(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",e)("return%j",F(t,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",e)("return%j",F(t,"boolean key"));break}return n}function ns(n){var t=Wt.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),e=n.oneofsArray,r={};e.length&&t("var p={}");for(var i=0;i<n.fieldsArray.length;++i){var s=n._fieldsArray[i].resolve(),o="m"+Wt.safeProp(s.name);if(s.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)t("if(!util.isObject(%s))",o)("return%j",F(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),rs(t,s,"k[i]"),$t(t,s,i,o+"[k[i]]")("}");else if(s.repeated)t("if(!Array.isArray(%s))",o)("return%j",F(s,"array"))("for(var i=0;i<%s.length;++i){",o),$t(t,s,i,o+"[i]")("}");else{if(s.partOf){var a=Wt.safeProp(s.partOf.name);r[s.partOf.name]===1&&t("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),r[s.partOf.name]=1,t("p%s=1",a)}$t(t,s,i,o)}s.optional&&t("}")}return t("return null")}});var Kt=d($n=>{"use strict";var Wn=$n,Ae=H(),G=P();function Vt(n,t,e,r){var i=!1;if(t.resolvedType)if(t.resolvedType instanceof Ae){n("switch(d%s){",r);for(var s=t.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===t.typeDefault&&!i&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),t.repeated||n("break"),i=!0),n("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",r,s[o[a]])("break");n("}")}else n('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,e,r);else{var u=!1;switch(t.type){case"double":case"float":n("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",r,r);break;case"uint64":u=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,u)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,u?"true":"");break;case"bytes":n('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":n("m%s=String(d%s)",r,r);break;case"bool":n("m%s=Boolean(d%s)",r,r);break}}return n}Wn.fromObject=function(t){var e=t.fieldsArray,r=G.codegen(["d"],t.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!e.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<e.length;++i){var s=e[i].resolve(),o=G.safeProp(s.name);s.map?(r("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Vt(r,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Vt(r,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof Ae||r("if(d%s!=null){",o),Vt(r,s,i,o),s.resolvedType instanceof Ae||r("}"))}return r("return m")};function Gt(n,t,e,r){if(t.resolvedType)t.resolvedType instanceof Ae?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,e,r,r,e,r,r):n("d%s=types[%i].toObject(m%s,o)",r,e,r);else{var i=!1;switch(t.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,i?"true":"",r);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:n("d%s=m%s",r,r);break}}return n}Wn.toObject=function(t){var e=t.fieldsArray.slice().sort(G.compareFieldsById);if(!e.length)return G.codegen()("return {}");for(var r=G.codegen(["m","o"],t.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<e.length;++a)e[a].partOf||(e[a].resolve().repeated?i:e[a].map?s:o).push(e[a]);if(i.length){for(r("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)r("d%s=[]",G.safeProp(i[a].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),a=0;a<s.length;++a)r("d%s={}",G.safeProp(s[a].name));r("}")}if(o.length){for(r("if(o.defaults){"),a=0;a<o.length;++a){var u=o[a],c=G.safeProp(u.name);if(u.resolvedType instanceof Ae)r("d%s=o.enums===String?%j:%j",c,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var l="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",c,l)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else r("d%s=%j",c,u.typeDefault)}r("}")}var b=!1;for(a=0;a<e.length;++a){var u=e[a],x=t._fieldsArray.indexOf(u),c=G.safeProp(u.name);u.map?(b||(b=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),Gt(r,u,x,c+"[ks2[j]]")("}")):u.repeated?(r("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),Gt(r,u,x,c+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",c,u.name),Gt(r,u,x,c),u.partOf&&r("if(o.oneofs)")("d%s=%j",G.safeProp(u.partOf.name),u.name)),r("}")}return r("return d")}});var Zt=d(Hn=>{"use strict";var is=Hn,ss=Ye();is[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var t=n["@type"].substring(n["@type"].lastIndexOf("/")+1),e=this.lookup(t);if(e){var r=n["@type"].charAt(0)==="."?n["@type"].slice(1):n["@type"];return r.indexOf("/")===-1&&(r="/"+r),this.create({type_url:r,value:e.encode(e.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,t){var e="type.googleapis.com/",r="",i="";if(t&&t.json&&n.type_url&&n.value){i=n.type_url.substring(n.type_url.lastIndexOf("/")+1),r=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof ss){var o=n.$type.toObject(n,t),a=n.$type.fullName[0]==="."?n.$type.fullName.slice(1):n.$type.fullName;return r===""&&(r=e),i=r+a,o["@type"]=i,o}return this.toObject(n,t)}}});var er=d((sa,Gn)=>{"use strict";Gn.exports=O;var z=me();((O.prototype=Object.create(z.prototype)).constructor=O).className="Type";var os=H(),Yt=ke(),et=oe(),as=jt(),us=Ut(),Xt=Ye(),Qt=Ge(),cs=He(),C=P(),ls=tr(),hs=zt(),fs=Ht(),Vn=Kt(),ds=Zt();function O(n,t){z.call(this,n,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(O.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),t=0;t<n.length;++t){var e=this.fields[n[t]],r=e.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=e}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=C.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=C.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=O.generateConstructor(this)())},set:function(n){var t=n.prototype;t instanceof Xt||((n.prototype=new Xt).constructor=n,C.merge(n.prototype,t)),n.$type=n.prototype.$type=this,C.merge(n,Xt,!0),this._ctor=n;for(var e=0;e<this.fieldsArray.length;++e)this._fieldsArray[e].resolve();var r={};for(e=0;e<this.oneofsArray.length;++e)r[this._oneofsArray[e].resolve().name]={get:C.oneOfGetter(this._oneofsArray[e].oneof),set:C.oneOfSetter(this._oneofsArray[e].oneof)};e&&Object.defineProperties(n.prototype,r)}}});O.generateConstructor=function(t){for(var e=C.codegen(["p"],t.name),r=0,i;r<t.fieldsArray.length;++r)(i=t._fieldsArray[r]).map?e("this%s={}",C.safeProp(i.name)):i.repeated&&e("this%s=[]",C.safeProp(i.name));return e("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function tt(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}O.fromJSON=function(t,e){var r=new O(t,e.options);r.extensions=e.extensions,r.reserved=e.reserved;for(var i=Object.keys(e.fields),s=0;s<i.length;++s)r.add((typeof e.fields[i[s]].keyType<"u"?as.fromJSON:et.fromJSON)(i[s],e.fields[i[s]]));if(e.oneofs)for(i=Object.keys(e.oneofs),s=0;s<i.length;++s)r.add(Yt.fromJSON(i[s],e.oneofs[i[s]]));if(e.nested)for(i=Object.keys(e.nested),s=0;s<i.length;++s){var o=e.nested[i[s]];r.add((o.id!==void 0?et.fromJSON:o.fields!==void 0?O.fromJSON:o.values!==void 0?os.fromJSON:o.methods!==void 0?us.fromJSON:z.fromJSON)(i[s],o))}return e.extensions&&e.extensions.length&&(r.extensions=e.extensions),e.reserved&&e.reserved.length&&(r.reserved=e.reserved),e.group&&(r.group=!0),e.comment&&(r.comment=e.comment),r};O.prototype.toJSON=function(t){var e=z.prototype.toJSON.call(this,t),r=t?!!t.keepComments:!1;return C.toObject(["options",e&&e.options||void 0,"oneofs",z.arrayToJSON(this.oneofsArray,t),"fields",z.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),t)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",e&&e.nested||void 0,"comment",r?this.comment:void 0])};O.prototype.resolveAll=function(){for(var t=this.fieldsArray,e=0;e<t.length;)t[e++].resolve();var r=this.oneofsArray;for(e=0;e<r.length;)r[e++].resolve();return z.prototype.resolveAll.call(this)};O.prototype.get=function(t){return this.fields[t]||this.oneofs&&this.oneofs[t]||this.nested&&this.nested[t]||null};O.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);if(t instanceof et&&t.extend===void 0){if(this._fieldsById?this._fieldsById[t.id]:this.fieldsById[t.id])throw Error("duplicate id "+t.id+" in "+this);if(this.isReservedId(t.id))throw Error("id "+t.id+" is reserved in "+this);if(this.isReservedName(t.name))throw Error("name '"+t.name+"' is reserved in "+this);return t.parent&&t.parent.remove(t),this.fields[t.name]=t,t.message=this,t.onAdd(this),tt(this)}return t instanceof Yt?(this.oneofs||(this.oneofs={}),this.oneofs[t.name]=t,t.onAdd(this),tt(this)):z.prototype.add.call(this,t)};O.prototype.remove=function(t){if(t instanceof et&&t.extend===void 0){if(!this.fields||this.fields[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.fields[t.name],t.parent=null,t.onRemove(this),tt(this)}if(t instanceof Yt){if(!this.oneofs||this.oneofs[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.oneofs[t.name],t.parent=null,t.onRemove(this),tt(this)}return z.prototype.remove.call(this,t)};O.prototype.isReservedId=function(t){return z.isReservedId(this.reserved,t)};O.prototype.isReservedName=function(t){return z.isReservedName(this.reserved,t)};O.prototype.create=function(t){return new this.ctor(t)};O.prototype.setup=function(){for(var t=this.fullName,e=[],r=0;r<this.fieldsArray.length;++r)e.push(this._fieldsArray[r].resolve().resolvedType);this.encode=ls(this)({Writer:cs,types:e,util:C}),this.decode=hs(this)({Reader:Qt,types:e,util:C}),this.verify=fs(this)({types:e,util:C}),this.fromObject=Vn.fromObject(this)({types:e,util:C}),this.toObject=Vn.toObject(this)({types:e,util:C});var i=ds[t];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};O.prototype.encode=function(t,e){return this.setup().encode(t,e)};O.prototype.encodeDelimited=function(t,e){return this.encode(t,e&&e.len?e.fork():e).ldelim()};O.prototype.decode=function(t,e){return this.setup().decode(t,e)};O.prototype.decodeDelimited=function(t){return t instanceof Qt||(t=Qt.create(t)),this.decode(t,t.uint32())};O.prototype.verify=function(t){return this.setup().verify(t)};O.prototype.fromObject=function(t){return this.setup().fromObject(t)};O.prototype.toObject=function(t,e){return this.setup().toObject(t,e)};O.d=function(t){return function(r){C.decorateType(r,t)}}});var ir=d((oa,Yn)=>{"use strict";Yn.exports=q;var nt=me();((q.prototype=Object.create(nt.prototype)).constructor=q).className="Root";var nr=oe(),Zn=H(),ps=ke(),te=P(),Xn,rr,qe;function q(n){nt.call(this,"",n),this.deferred=[],this.files=[]}q.fromJSON=function(t,e){return e||(e=new q),t.options&&e.setOptions(t.options),e.addJSON(t.nested)};q.prototype.resolvePath=te.path.resolve;q.prototype.fetch=te.fetch;function Qn(){}q.prototype.load=function n(t,e,r){typeof e=="function"&&(r=e,e=void 0);var i=this;if(!r)return te.asPromise(n,i,t,e);var s=r===Qn;function o(p,f){if(r){var y=r;if(r=null,s)throw p;y(p,f)}}function a(p){var f=p.lastIndexOf("google/protobuf/");if(f>-1){var y=p.substring(f);if(y in qe)return y}return null}function u(p,f){try{if(te.isString(f)&&f.charAt(0)==="{"&&(f=JSON.parse(f)),!te.isString(f))i.setOptions(f.options).addJSON(f.nested);else{rr.filename=p;var y=rr(f,i,e),v,w=0;if(y.imports)for(;w<y.imports.length;++w)(v=a(y.imports[w])||i.resolvePath(p,y.imports[w]))&&c(v);if(y.weakImports)for(w=0;w<y.weakImports.length;++w)(v=a(y.weakImports[w])||i.resolvePath(p,y.weakImports[w]))&&c(v,!0)}}catch(ge){o(ge)}!s&&!l&&o(null,i)}function c(p,f){if(p=a(p)||p,!(i.files.indexOf(p)>-1)){if(i.files.push(p),p in qe){s?u(p,qe[p]):(++l,setTimeout(function(){--l,u(p,qe[p])}));return}if(s){var y;try{y=te.fs.readFileSync(p).toString("utf8")}catch(v){f||o(v);return}u(p,y)}else++l,i.fetch(p,function(v,w){if(--l,!!r){if(v){f?l||o(null,i):o(v);return}u(p,w)}})}}var l=0;te.isString(t)&&(t=[t]);for(var b=0,x;b<t.length;++b)(x=i.resolvePath("",t[b]))&&c(x);if(s)return i;l||o(null,i)};q.prototype.loadSync=function(t,e){if(!te.isNode)throw Error("not supported");return this.load(t,e,Qn)};q.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(t){return"'extend "+t.extend+"' in "+t.parent.fullName}).join(", "));return nt.prototype.resolveAll.call(this)};var rt=/^[A-Z]/;function Kn(n,t){var e=t.parent.lookup(t.extend);if(e){var r=new nr(t.fullName,t.id,t.type,t.rule,void 0,t.options);return e.get(r.name)||(r.declaringField=t,t.extensionField=r,e.add(r)),!0}return!1}q.prototype._handleAdd=function(t){if(t instanceof nr)t.extend!==void 0&&!t.extensionField&&(Kn(this,t)||this.deferred.push(t));else if(t instanceof Zn)rt.test(t.name)&&(t.parent[t.name]=t.values);else if(!(t instanceof ps)){if(t instanceof Xn)for(var e=0;e<this.deferred.length;)Kn(this,this.deferred[e])?this.deferred.splice(e,1):++e;for(var r=0;r<t.nestedArray.length;++r)this._handleAdd(t._nestedArray[r]);rt.test(t.name)&&(t.parent[t.name]=t)}};q.prototype._handleRemove=function(t){if(t instanceof nr){if(t.extend!==void 0)if(t.extensionField)t.extensionField.parent.remove(t.extensionField),t.extensionField=null;else{var e=this.deferred.indexOf(t);e>-1&&this.deferred.splice(e,1)}}else if(t instanceof Zn)rt.test(t.name)&&delete t.parent[t.name];else if(t instanceof nt){for(var r=0;r<t.nestedArray.length;++r)this._handleRemove(t._nestedArray[r]);rt.test(t.name)&&delete t.parent[t.name]}};q._configure=function(n,t,e){Xn=n,rr=t,qe=e}});var P=d((aa,ti)=>{"use strict";var T=ti.exports=W(),ei=Ct(),sr,or;T.codegen=bn();T.fetch=wn();T.path=On();T.fs=T.inquire("fs");T.toArray=function(t){if(t){for(var e=Object.keys(t),r=new Array(e.length),i=0;i<e.length;)r[i]=t[e[i++]];return r}return[]};T.toObject=function(t){for(var e={},r=0;r<t.length;){var i=t[r++],s=t[r++];s!==void 0&&(e[i]=s)}return e};var ys=/\\/g,ms=/"/g;T.isReserved=function(t){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(t)};T.safeProp=function(t){return!/^[$\w_]+$/.test(t)||T.isReserved(t)?'["'+t.replace(ys,"\\\\").replace(ms,'\\"')+'"]':"."+t};T.ucFirst=function(t){return t.charAt(0).toUpperCase()+t.substring(1)};var _s=/_([a-z])/g;T.camelCase=function(t){return t.substring(0,1)+t.substring(1).replace(_s,function(e,r){return r.toUpperCase()})};T.compareFieldsById=function(t,e){return t.id-e.id};T.decorateType=function(t,e){if(t.$type)return e&&t.$type.name!==e&&(T.decorateRoot.remove(t.$type),t.$type.name=e,T.decorateRoot.add(t.$type)),t.$type;sr||(sr=er());var r=new sr(e||t.name);return T.decorateRoot.add(r),r.ctor=t,Object.defineProperty(t,"$type",{value:r,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:r,enumerable:!1}),r};var gs=0;T.decorateEnum=function(t){if(t.$type)return t.$type;or||(or=H());var e=new or("Enum"+gs++,t);return T.decorateRoot.add(e),Object.defineProperty(t,"$type",{value:e,enumerable:!1}),e};T.setProperty=function(t,e,r){function i(s,o,a){var u=o.shift();if(u==="__proto__"||u==="prototype")return s;if(o.length>0)s[u]=i(s[u]||{},o,a);else{var c=s[u];c&&(a=[].concat(c).concat(a)),s[u]=a}return s}if(typeof t!="object")throw TypeError("dst must be an object");if(!e)throw TypeError("path must be specified");return e=e.split("."),i(t,e,r)};Object.defineProperty(T,"decorateRoot",{get:function(){return ei.decorated||(ei.decorated=new(ir()))}})});var ae=d((ua,ri)=>{"use strict";ri.exports=D;D.className="ReflectionObject";var it=P(),st;function D(n,t){if(!it.isString(n))throw TypeError("name must be a string");if(t&&!it.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=n,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(D.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],t=this.parent;t;)n.unshift(t.name),t=t.parent;return n.join(".")}}});D.prototype.toJSON=function(){throw Error()};D.prototype.onAdd=function(t){this.parent&&this.parent!==t&&this.parent.remove(this),this.parent=t,this.resolved=!1;var e=t.root;e instanceof st&&e._handleAdd(this)};D.prototype.onRemove=function(t){var e=t.root;e instanceof st&&e._handleRemove(this),this.parent=null,this.resolved=!1};D.prototype.resolve=function(){return this.resolved?this:(this.root instanceof st&&(this.resolved=!0),this)};D.prototype.getOption=function(t){if(this.options)return this.options[t]};D.prototype.setOption=function(t,e,r){return(!r||!this.options||this.options[t]===void 0)&&((this.options||(this.options={}))[t]=e),this};D.prototype.setParsedOption=function(t,e,r){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(r){var s=i.find(function(u){return Object.prototype.hasOwnProperty.call(u,t)});if(s){var o=s[t];it.setProperty(o,r,e)}else s={},s[t]=it.setProperty({},r,e),i.push(s)}else{var a={};a[t]=e,i.push(a)}return this};D.prototype.setOptions=function(t,e){if(t)for(var r=Object.keys(t),i=0;i<r.length;++i)this.setOption(r[i],t[r[i]],e);return this};D.prototype.toString=function(){var t=this.constructor.className,e=this.fullName;return e.length?t+" "+e:t};D._configure=function(n){st=n}});var H=d((ca,si)=>{"use strict";si.exports=K;var ni=ae();((K.prototype=Object.create(ni.prototype)).constructor=K).className="Enum";var ii=me(),ot=P();function K(n,t,e,r,i,s){if(ni.call(this,n,e),t&&typeof t!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=i||{},this.valuesOptions=s,this.reserved=void 0,t)for(var o=Object.keys(t),a=0;a<o.length;++a)typeof t[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=t[o[a]]]=o[a])}K.fromJSON=function(t,e){var r=new K(t,e.values,e.options,e.comment,e.comments);return r.reserved=e.reserved,r};K.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return ot.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",e?this.comment:void 0,"comments",e?this.comments:void 0])};K.prototype.add=function(t,e,r,i){if(!ot.isString(t))throw TypeError("name must be a string");if(!ot.isInteger(e))throw TypeError("id must be an integer");if(this.values[t]!==void 0)throw Error("duplicate name '"+t+"' in "+this);if(this.isReservedId(e))throw Error("id "+e+" is reserved in "+this);if(this.isReservedName(t))throw Error("name '"+t+"' is reserved in "+this);if(this.valuesById[e]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+e+" in "+this);this.values[t]=e}else this.valuesById[this.values[t]=e]=t;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[t]=i||null),this.comments[t]=r||null,this};K.prototype.remove=function(t){if(!ot.isString(t))throw TypeError("name must be a string");var e=this.values[t];if(e==null)throw Error("name '"+t+"' does not exist in "+this);return delete this.valuesById[e],delete this.values[t],delete this.comments[t],this.valuesOptions&&delete this.valuesOptions[t],this};K.prototype.isReservedId=function(t){return ii.isReservedId(this.reserved,t)};K.prototype.isReservedName=function(t){return ii.isReservedName(this.reserved,t)}});var tr=d((la,ai)=>{"use strict";ai.exports=vs;var bs=H(),ar=de(),ur=P();function oi(n,t,e,r){return t.resolvedType.group?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",e,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",e,r,(t.id<<3|2)>>>0)}function vs(n){for(var t=ur.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),e,r,i=n.fieldsArray.slice().sort(ur.compareFieldsById),e=0;e<i.length;++e){var s=i[e].resolve(),o=n._fieldsArray.indexOf(s),a=s.resolvedType instanceof bs?"int32":s.type,u=ar.basic[a];r="m"+ur.safeProp(s.name),s.map?(t("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|ar.mapKey[s.keyType],s.keyType),u===void 0?t("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,r):t(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|u,a,r),t("}")("}")):s.repeated?(t("if(%s!=null&&%s.length){",r,r),s.packed&&ar.packed[a]!==void 0?t("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",a,r)("w.ldelim()"):(t("for(var i=0;i<%s.length;++i)",r),u===void 0?oi(t,s,o,r+"[i]"):t("w.uint32(%i).%s(%s[i])",(s.id<<3|u)>>>0,a,r)),t("}")):(s.optional&&t("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,s.name),u===void 0?oi(t,s,o,r):t("w.uint32(%i).%s(%s)",(s.id<<3|u)>>>0,a,r))}return t("return w")}});var ci=d((ha,ui)=>{"use strict";var m=ui.exports=_n();m.build="light";function ws(n,t,e){return typeof t=="function"?(e=t,t=new m.Root):t||(t=new m.Root),t.load(n,e)}m.load=ws;function Ss(n,t){return t||(t=new m.Root),t.loadSync(n)}m.loadSync=Ss;m.encoder=tr();m.decoder=zt();m.verifier=Ht();m.converter=Kt();m.ReflectionObject=ae();m.Namespace=me();m.Root=ir();m.Enum=H();m.Type=er();m.Field=oe();m.OneOf=ke();m.MapField=jt();m.Service=Ut();m.Method=Jt();m.Message=Ye();m.wrappers=Zt();m.types=de();m.util=P();m.ReflectionObject._configure(m.Root);m.Namespace._configure(m.Type,m.Service,m.Enum);m.Root._configure(m.Type);m.Field._configure(m.Type)});var hi=d((fa,li)=>{"use strict";li.exports=ci()});var Or=lt(ft());var Le=(r=>(r.Disconnected="disconnected",r.Connecting="connecting",r.Connected="connected",r))(Le||{}),Ie=(r=>(r.Unsubscribed="unsubscribed",r.Subscribing="subscribing",r.Subscribed="subscribed",r))(Ie||{});function wr(n,t){return n.lastIndexOf(t,0)===0}function dt(n){return n==null?!1:typeof n=="function"}function Sr(n,t){if(globalThis.console){let e=globalThis.console[n];dt(e)&&e.apply(globalThis.console,t)}}function ki(n,t){return Math.floor(Math.random()*(t-n+1)+n)}function le(n,t,e){n>31&&(n=31);let r=ki(0,Math.min(e,t*Math.pow(2,n)));return Math.min(e,t+r)}function xr(n){return"error"in n&&n.error!==null}function he(n){return Math.min(n*1e3,2147483647)}var Be=class extends Or.default{constructor(e,r,i){super();this._resubscribeTimeout=null;this._refreshTimeout=null;this.channel=r,this.state="unsubscribed",this._centrifuge=e,this._token="",this._getToken=null,this._data=null,this._getData=null,this._recover=!1,this._offset=null,this._epoch=null,this._recoverable=!1,this._positioned=!1,this._joinLeave=!1,this._minResubscribeDelay=500,this._maxResubscribeDelay=2e4,this._resubscribeTimeout=null,this._resubscribeAttempts=0,this._promises={},this._promiseId=0,this._inflight=!1,this._refreshTimeout=null,this._delta="",this._delta_negotiated=!1,this._prevValue=null,this._unsubPromise=Promise.resolve(),this._setOptions(i),this._centrifuge._debugEnabled?(this.on("state",s=>{this._debug("subscription state",r,s.oldState,"->",s.newState)}),this.on("error",s=>{this._debug("subscription error",r,s)})):this.on("error",function(){Function.prototype()})}ready(e){return this.state==="unsubscribed"?Promise.reject({code:7,message:this.state}):this.state==="subscribed"?Promise.resolve():new Promise((r,i)=>{let s={resolve:r,reject:i};e&&(s.timeout=setTimeout(function(){i({code:1,message:"timeout"})},e)),this._promises[this._nextPromiseId()]=s})}subscribe(){this._isSubscribed()||(this._resubscribeAttempts=0,this._setSubscribing(0,"subscribe called"))}unsubscribe(){this._unsubPromise=this._setUnsubscribed(0,"unsubscribe called",!0)}publish(e){let r=this;return this._methodCall().then(function(){return r._centrifuge.publish(r.channel,e)})}presence(){let e=this;return this._methodCall().then(function(){return e._centrifuge.presence(e.channel)})}presenceStats(){let e=this;return this._methodCall().then(function(){return e._centrifuge.presenceStats(e.channel)})}history(e){let r=this;return this._methodCall().then(function(){return r._centrifuge.history(r.channel,e)})}_methodCall(){return this._isSubscribed()?Promise.resolve():this._isUnsubscribed()?Promise.reject({code:7,message:this.state}):new Promise((e,r)=>{let i=setTimeout(function(){r({code:1,message:"timeout"})},this._centrifuge._config.timeout);this._promises[this._nextPromiseId()]={timeout:i,resolve:e,reject:r}})}_nextPromiseId(){return++this._promiseId}_needRecover(){return this._recover===!0}_isUnsubscribed(){return this.state==="unsubscribed"}_isSubscribing(){return this.state==="subscribing"}_isSubscribed(){return this.state==="subscribed"}_setState(e){if(this.state!==e){let r=this.state;return this.state=e,this.emit("state",{newState:e,oldState:r,channel:this.channel}),!0}return!1}_usesToken(){return this._token!==""||this._getToken!==null}_clearSubscribingState(){this._resubscribeAttempts=0,this._clearResubscribeTimeout()}_clearSubscribedState(){this._clearRefreshTimeout()}_setSubscribed(e){if(!this._isSubscribing())return;this._clearSubscribingState(),e.recoverable&&(this._recover=!0,this._offset=e.offset||0,this._epoch=e.epoch||""),e.delta?this._delta_negotiated=!0:this._delta_negotiated=!1,this._setState("subscribed");let r=this._centrifuge._getSubscribeContext(this.channel,e);this.emit("subscribed",r),this._resolvePromises();let i=e.publications;if(i&&i.length>0)for(let s in i)i.hasOwnProperty(s)&&this._handlePublication(i[s]);e.expires===!0&&(this._refreshTimeout=setTimeout(()=>this._refresh(),he(e.ttl)))}async _setSubscribing(e,r){this._isSubscribing()||(this._isSubscribed()&&this._clearSubscribedState(),this._setState("subscribing")&&this.emit("subscribing",{channel:this.channel,code:e,reason:r}),this._centrifuge._transport&&this._centrifuge._transport.emulation()&&await this._unsubPromise,this._isSubscribing()&&this._subscribe())}_subscribe(){return this._debug("subscribing on",this.channel),this._isTransportOpen()?this._inflight?null:(this._inflight=!0,this._canSubscribeWithoutGettingToken()?this._subscribeWithoutToken():(this._getSubscriptionToken().then(e=>this._handleTokenResponse(e)).catch(e=>this._handleTokenError(e)),null)):(this._debug("delay subscribe on",this.channel,"till connected"),null)}_isTransportOpen(){return this._centrifuge._transportIsOpen}_canSubscribeWithoutGettingToken(){return!this._usesToken()||!!this._token}_subscribeWithoutToken(){return this._getData?(this._getDataAndSubscribe(this._token),null):this._sendSubscribe(this._token)}_getDataAndSubscribe(e){if(!this._getData){this._inflight=!1;return}this._getData({channel:this.channel}).then(r=>{if(!this._isSubscribing()){this._inflight=!1;return}this._data=r,this._sendSubscribe(e)}).catch(r=>this._handleGetDataError(r))}_handleGetDataError(e){if(!this._isSubscribing()){this._inflight=!1;return}if(e instanceof N){this._inflight=!1,this._failUnauthorized();return}this.emit("error",{type:"subscribeData",channel:this.channel,error:{code:12,message:e?.toString()||""}}),this._inflight=!1,this._scheduleResubscribe()}_handleTokenResponse(e){if(!this._isSubscribing()){this._inflight=!1;return}if(!e){this._inflight=!1,this._failUnauthorized();return}this._token=e,this._getData?this._getDataAndSubscribe(e):this._sendSubscribe(e)}_handleTokenError(e){if(!this._isSubscribing()){this._inflight=!1;return}if(e instanceof N){this._inflight=!1,this._failUnauthorized();return}this.emit("error",{type:"subscribeToken",channel:this.channel,error:{code:8,message:e?.toString()||""}}),this._inflight=!1,this._scheduleResubscribe()}_sendSubscribe(e){if(!this._isTransportOpen())return this._inflight=!1,null;let r=this._buildSubscribeCommand(e);return this._centrifuge._call(r).then(i=>{this._inflight=!1;let s=i.reply.subscribe;this._handleSubscribeResponse(s),i.next&&i.next()},i=>{this._inflight=!1,this._handleSubscribeError(i.error),i.next&&i.next()}),r}_buildSubscribeCommand(e){let r={channel:this.channel};if(e&&(r.token=e),this._data&&(r.data=this._data),this._positioned&&(r.positioned=!0),this._recoverable&&(r.recoverable=!0),this._joinLeave&&(r.join_leave=!0),this._needRecover()){r.recover=!0;let i=this._getOffset();i&&(r.offset=i);let s=this._getEpoch();s&&(r.epoch=s)}return this._delta&&(r.delta=this._delta),{subscribe:r}}_debug(...e){this._centrifuge._debug(...e)}_handleSubscribeError(e){if(this._isSubscribing()){if(e.code===1){this._centrifuge._disconnect(3,"subscribe timeout",!0);return}this._subscribeError(e)}}_handleSubscribeResponse(e){this._isSubscribing()&&this._setSubscribed(e)}_setUnsubscribed(e,r,i){if(this._isUnsubscribed())return Promise.resolve();let s=Promise.resolve();return this._isSubscribed()?(i&&(s=this._centrifuge._unsubscribe(this)),this._clearSubscribedState()):this._isSubscribing()&&(this._inflight&&i&&(s=this._centrifuge._unsubscribe(this)),this._clearSubscribingState()),this._inflight=!1,this._setState("unsubscribed")&&this.emit("unsubscribed",{channel:this.channel,code:e,reason:r}),this._rejectPromises({code:7,message:this.state}),s}_handlePublication(e){if(this._delta&&this._delta_negotiated){let{newData:i,newPrevValue:s}=this._centrifuge._codec.applyDeltaIfNeeded(e,this._prevValue);e.data=i,this._prevValue=s}let r=this._centrifuge._getPublicationContext(this.channel,e);this.emit("publication",r),e.offset&&(this._offset=e.offset)}_handleJoin(e){let r=this._centrifuge._getJoinLeaveContext(e.info);this.emit("join",{channel:this.channel,info:r})}_handleLeave(e){let r=this._centrifuge._getJoinLeaveContext(e.info);this.emit("leave",{channel:this.channel,info:r})}_resolvePromises(){for(let e in this._promises)this._promises.hasOwnProperty(e)&&(this._promises[e].timeout&&clearTimeout(this._promises[e].timeout),this._promises[e].resolve(),delete this._promises[e])}_rejectPromises(e){for(let r in this._promises)this._promises.hasOwnProperty(r)&&(this._promises[r].timeout&&clearTimeout(this._promises[r].timeout),this._promises[r].reject(e),delete this._promises[r])}_scheduleResubscribe(){if(!this._isSubscribing()){this._debug("not in subscribing state, skip resubscribe scheduling",this.channel);return}let e=this,r=this._getResubscribeDelay();this._resubscribeTimeout=setTimeout(function(){e._isSubscribing()&&e._subscribe()},r),this._debug("resubscribe scheduled after "+r,this.channel)}_subscribeError(e){if(this._isSubscribing())if(e.code<100||e.code===109||e.temporary===!0){e.code===109&&(this._token="");let r={channel:this.channel,type:"subscribe",error:e};this._centrifuge.state==="connected"&&this.emit("error",r),this._scheduleResubscribe()}else this._setUnsubscribed(e.code,e.message,!1)}_getResubscribeDelay(){let e=le(this._resubscribeAttempts,this._minResubscribeDelay,this._maxResubscribeDelay);return this._resubscribeAttempts++,e}_setOptions(e){if(e&&(e.since&&(this._offset=e.since.offset||0,this._epoch=e.since.epoch||"",this._recover=!0),e.data&&(this._data=e.data),e.getData&&(this._getData=e.getData),e.minResubscribeDelay!==void 0&&(this._minResubscribeDelay=e.minResubscribeDelay),e.maxResubscribeDelay!==void 0&&(this._maxResubscribeDelay=e.maxResubscribeDelay),e.token&&(this._token=e.token),e.getToken&&(this._getToken=e.getToken),e.positioned===!0&&(this._positioned=!0),e.recoverable===!0&&(this._recoverable=!0),e.joinLeave===!0&&(this._joinLeave=!0),e.delta)){if(e.delta!=="fossil")throw new Error("unsupported delta format");this._delta=e.delta}}_getOffset(){let e=this._offset;return e!==null?e:0}_getEpoch(){let e=this._epoch;return e!==null?e:""}_clearRefreshTimeout(){this._refreshTimeout!==null&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearResubscribeTimeout(){this._resubscribeTimeout!==null&&(clearTimeout(this._resubscribeTimeout),this._resubscribeTimeout=null)}_getSubscriptionToken(){this._debug("get subscription token for channel",this.channel);let e={channel:this.channel},r=this._getToken;return r===null?(this.emit("error",{type:"configuration",channel:this.channel,error:{code:12,message:"provide a function to get channel subscription token"}}),Promise.reject(new N(""))):r(e)}_refresh(){this._clearRefreshTimeout();let e=this;this._getSubscriptionToken().then(function(r){if(!e._isSubscribed())return;if(!r){e._failUnauthorized();return}e._token=r;let s={sub_refresh:{channel:e.channel,token:r}};e._centrifuge._call(s).then(o=>{let a=o.reply.sub_refresh;e._refreshResponse(a),o.next&&o.next()},o=>{e._refreshError(o.error),o.next&&o.next()})}).catch(function(r){if(r instanceof N){e._failUnauthorized();return}e.emit("error",{type:"refreshToken",channel:e.channel,error:{code:9,message:r!==void 0?r.toString():""}}),e._refreshTimeout=setTimeout(()=>e._refresh(),e._getRefreshRetryDelay())})}_refreshResponse(e){this._isSubscribed()&&(this._debug("subscription token refreshed, channel",this.channel),this._clearRefreshTimeout(),e.expires===!0&&(this._refreshTimeout=setTimeout(()=>this._refresh(),he(e.ttl))))}_refreshError(e){this._isSubscribed()&&(e.code<100||e.temporary===!0?(this.emit("error",{type:"refresh",channel:this.channel,error:e}),this._refreshTimeout=setTimeout(()=>this._refresh(),this._getRefreshRetryDelay())):this._setUnsubscribed(e.code,e.message,!0))}_getRefreshRetryDelay(){return le(0,1e4,2e4)}_failUnauthorized(){this._setUnsubscribed(1,"unauthorized",!0)}};var je=class{constructor(t,e){this.endpoint=t,this.options=e,this._transport=null}name(){return"sockjs"}subName(){return"sockjs-"+this._transport.transport}emulation(){return!1}supported(){return this.options.sockjs!==null}initialize(t,e){this._transport=new this.options.sockjs(this.endpoint,null,this.options.sockjsOptions),this._transport.onopen=()=>{e.onOpen()},this._transport.onerror=r=>{e.onError(r)},this._transport.onclose=r=>{e.onClose(r)},this._transport.onmessage=r=>{e.onMessage(r.data)}}close(){this._transport.close()}send(t){this._transport.send(t)}};var be=class{constructor(t,e){this.endpoint=t,this.options=e,this._transport=null}name(){return"websocket"}subName(){return"websocket"}emulation(){return!1}supported(){return this.options.websocket!==void 0&&this.options.websocket!==null}initialize(t,e){let r="";t==="protobuf"&&(r="centrifuge-protobuf"),r!==""?this._transport=new this.options.websocket(this.endpoint,r):this._transport=new this.options.websocket(this.endpoint),t==="protobuf"&&(this._transport.binaryType="arraybuffer"),this._transport.onopen=()=>{e.onOpen()},this._transport.onerror=i=>{e.onError(i)},this._transport.onclose=i=>{e.onClose(i)},this._transport.onmessage=i=>{e.onMessage(i.data)}}close(){this._transport.close()}send(t){this._transport.send(t)}};var Fe=class{constructor(t,e){this.endpoint=t,this.options=e,this._abortController=null,this._utf8decoder=new TextDecoder,this._protocol="json"}name(){return"http_stream"}subName(){return"http_stream"}emulation(){return!0}_handleErrors(t){if(!t.ok)throw new Error(t.status);return t}_fetchEventTarget(t,e,r){let i=new EventTarget,s=t.options.fetch;return s(e,r).then(t._handleErrors).then(o=>{i.dispatchEvent(new Event("open"));let a="",u=0,c=new Uint8Array,l=o.body.getReader();return new t.options.readableStream({start(b){function x(){return l.read().then(({done:p,value:f})=>{if(p){i.dispatchEvent(new Event("close")),b.close();return}try{if(t._protocol==="json")for(a+=t._utf8decoder.decode(f);u<a.length;)if(a[u]===`
`){let y=a.substring(0,u);i.dispatchEvent(new MessageEvent("message",{data:y})),a=a.substring(u+1),u=0}else++u;else{let y=new Uint8Array(c.length+f.length);for(y.set(c),y.set(f,c.length),c=y;;){let v=t.options.decoder.decodeReply(c);if(v.ok){let w=c.slice(0,v.pos);i.dispatchEvent(new MessageEvent("message",{data:w})),c=c.slice(v.pos);continue}break}}}catch(y){i.dispatchEvent(new Event("error",{detail:y})),i.dispatchEvent(new Event("close")),b.close();return}x()}).catch(function(p){i.dispatchEvent(new Event("error",{detail:p})),i.dispatchEvent(new Event("close")),b.close()})}return x()}})}).catch(o=>{i.dispatchEvent(new Event("error",{detail:o})),i.dispatchEvent(new Event("close"))}),i}supported(){return this.options.fetch!==null&&this.options.readableStream!==null&&typeof TextDecoder<"u"&&typeof AbortController<"u"&&typeof EventTarget<"u"&&typeof Event<"u"&&typeof MessageEvent<"u"&&typeof Error<"u"}initialize(t,e,r){this._protocol=t,this._abortController=new AbortController;let i,s;t==="json"?(i={Accept:"application/json","Content-Type":"application/json"},s=r):(i={Accept:"application/octet-stream","Content-Type":"application/octet-stream"},s=r);let o={method:"POST",headers:i,body:s,mode:"cors",credentials:"same-origin",signal:this._abortController.signal},a=this._fetchEventTarget(this,this.endpoint,o);a.addEventListener("open",()=>{e.onOpen()}),a.addEventListener("error",u=>{this._abortController.abort(),e.onError(u)}),a.addEventListener("close",()=>{this._abortController.abort(),e.onClose({code:4,reason:"connection closed"})}),a.addEventListener("message",u=>{e.onMessage(u.data)})}close(){this._abortController.abort()}send(t,e,r){let i,s,o={session:e,node:r,data:t};this._protocol==="json"?(i={"Content-Type":"application/json"},s=JSON.stringify(o)):(i={"Content-Type":"application/octet-stream"},s=this.options.encoder.encodeEmulationRequest(o));let a=this.options.fetch,u={method:"POST",headers:i,body:s,mode:"cors",credentials:"same-origin"};a(this.options.emulationEndpoint,u)}};var Je=class{constructor(t,e){this.endpoint=t,this.options=e,this._protocol="json",this._transport=null,this._onClose=null}name(){return"sse"}subName(){return"sse"}emulation(){return!0}supported(){return this.options.eventsource!==null&&this.options.fetch!==null}initialize(t,e,r){let i;globalThis&&globalThis.document&&globalThis.document.baseURI?i=new URL(this.endpoint,globalThis.document.baseURI):i=new URL(this.endpoint),i.searchParams.append("cf_connect",r);let s={},o=new this.options.eventsource(i.toString(),s);this._transport=o;let a=this;o.onopen=function(){e.onOpen()},o.onerror=function(u){o.close(),e.onError(u),e.onClose({code:4,reason:"connection closed"})},o.onmessage=function(u){e.onMessage(u.data)},a._onClose=function(){e.onClose({code:4,reason:"connection closed"})}}close(){this._transport.close(),this._onClose!==null&&this._onClose()}send(t,e,r){let i={session:e,node:r,data:t},s={"Content-Type":"application/json"},o=JSON.stringify(i),a=this.options.fetch,u={method:"POST",headers:s,body:o,mode:"cors",credentials:"same-origin"};a(this.options.emulationEndpoint,u)}};var Me=class{constructor(t,e){this.endpoint=t,this.options=e,this._transport=null,this._stream=null,this._writer=null,this._utf8decoder=new TextDecoder,this._protocol="json"}name(){return"webtransport"}subName(){return"webtransport"}emulation(){return!1}supported(){return this.options.webtransport!==void 0&&this.options.webtransport!==null}async initialize(t,e){let r;globalThis&&globalThis.document&&globalThis.document.baseURI?r=new URL(this.endpoint,globalThis.document.baseURI):r=new URL(this.endpoint),t==="protobuf"&&r.searchParams.append("cf_protocol","protobuf"),this._protocol=t;let i=new EventTarget;this._transport=new this.options.webtransport(r.toString()),this._transport.closed.then(()=>{e.onClose({code:4,reason:"connection closed"})}).catch(()=>{e.onClose({code:4,reason:"connection closed"})});try{await this._transport.ready}catch{this.close();return}let s;try{s=await this._transport.createBidirectionalStream()}catch{this.close();return}this._stream=s,this._writer=this._stream.writable.getWriter(),i.addEventListener("close",()=>{e.onClose({code:4,reason:"connection closed"})}),i.addEventListener("message",o=>{e.onMessage(o.data)}),this._startReading(i),e.onOpen()}async _startReading(t){let e=this._stream.readable.getReader(),r="",i=0,s=new Uint8Array;try{for(;;){let{done:o,value:a}=await e.read();if(a.length>0)if(this._protocol==="json")for(r+=this._utf8decoder.decode(a);i<r.length;)if(r[i]===`
`){let u=r.substring(0,i);t.dispatchEvent(new MessageEvent("message",{data:u})),r=r.substring(i+1),i=0}else++i;else{let u=new Uint8Array(s.length+a.length);for(u.set(s),u.set(a,s.length),s=u;;){let c=this.options.decoder.decodeReply(s);if(c.ok){let l=s.slice(0,c.pos);t.dispatchEvent(new MessageEvent("message",{data:l})),s=s.slice(c.pos);continue}break}}if(o)break}}catch{t.dispatchEvent(new Event("close"))}}async close(){try{this._writer&&await this._writer.close(),this._transport.close()}catch{}}async send(t){let e;this._protocol==="json"?e=new TextEncoder().encode(t+`
`):e=t;try{await this._writer.write(e)}catch{this.close()}}};var Ai=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,36,-1,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,-1,-1,-1,63,-1],pt=class{constructor(t){this.a=t,this.pos=0}haveBytes(){return this.pos<this.a.length}getByte(){let t=this.a[this.pos];if(this.pos++,this.pos>this.a.length)throw new RangeError("out of bounds");return t}getChar(){return String.fromCharCode(this.getByte())}getInt(){let t=0,e;for(;this.haveBytes()&&(e=Ai[127&this.getByte()])>=0;)t=(t<<6)+e;return this.pos--,t>>>0}},yt=class{constructor(){this.a=[]}toByteArray(t){return Array.isArray(t)?this.a:new Uint8Array(this.a)}putArray(t,e,r){for(let i=e;i<r;i++)this.a.push(t[i])}};function qi(n){let t=0,e=0,r=0,i=0,s=0,o=n.length;for(;o>=16;)t=t+n[s+0]|0,e=e+n[s+1]|0,r=r+n[s+2]|0,i=i+n[s+3]|0,t=t+n[s+4]|0,e=e+n[s+5]|0,r=r+n[s+6]|0,i=i+n[s+7]|0,t=t+n[s+8]|0,e=e+n[s+9]|0,r=r+n[s+10]|0,i=i+n[s+11]|0,t=t+n[s+12]|0,e=e+n[s+13]|0,r=r+n[s+14]|0,i=i+n[s+15]|0,s+=16,o-=16;for(;o>=4;)t=t+n[s+0]|0,e=e+n[s+1]|0,r=r+n[s+2]|0,i=i+n[s+3]|0,s+=4,o-=4;switch(i=((i+(r<<8)|0)+(e<<16)|0)+(t<<24)|0,o){case 3:i=i+(n[s+2]<<8)|0;case 2:i=i+(n[s+1]<<16)|0;case 1:i=i+(n[s+0]<<24)|0}return i>>>0}function Ue(n,t){let e=0,r=new pt(t),i=n.length,s=t.length,o=r.getInt();if(r.getChar()!==`
`)throw new Error("size integer not terminated by '\\n'");let a=new yt;for(;r.haveBytes();){let u=r.getInt(),c;switch(r.getChar()){case"@":if(c=r.getInt(),r.haveBytes()&&r.getChar()!==",")throw new Error("copy command not terminated by ','");if(e+=u,e>o)throw new Error("copy exceeds output file size");if(c+u>i)throw new Error("copy extends past end of input");a.putArray(n,c,c+u);break;case":":if(e+=u,e>o)throw new Error("insert command gives an output larger than predicted");if(u>s)throw new Error("insert count exceeds size of delta");a.putArray(r.a,r.pos,r.pos+u),r.pos+=u;break;case";":{let l=a.toByteArray(n);if(u!==qi(l))throw new Error("bad checksum");if(e!==o)throw new Error("generated size does not match predicted size");return l}default:throw new Error("unknown delta operator")}}throw new Error("unterminated delta")}var ve=class{name(){return"json"}encodeCommands(t){return t.map(e=>JSON.stringify(e)).join(`
`)}decodeReplies(t){return t.trim().split(`
`).map(e=>JSON.parse(e))}applyDeltaIfNeeded(t,e){let r,i;if(t.delta){let s=Ue(e,new TextEncoder().encode(t.data));r=JSON.parse(new TextDecoder().decode(s)),i=s}else r=JSON.parse(t.data),i=new TextEncoder().encode(t.data);return{newData:r,newPrevValue:i}}};var Er=lt(ft()),Di={headers:{},token:"",getToken:null,data:null,getData:null,debug:!1,name:"js",version:"",fetch:null,readableStream:null,websocket:null,eventsource:null,sockjs:null,sockjsOptions:{},emulationEndpoint:"/emulation",minReconnectDelay:500,maxReconnectDelay:2e4,timeout:5e3,maxServerPingDelay:1e4,networkEventTarget:null},N=class extends Error{constructor(t){super(t),this.name=this.constructor.name}},ne=class extends Er.default{constructor(e,r){super();this._reconnectTimeout=null;this._refreshTimeout=null;this._serverPingTimeout=null;this.state="disconnected",this._transportIsOpen=!1,this._endpoint=e,this._emulation=!1,this._transports=[],this._currentTransportIndex=0,this._triedAllTransports=!1,this._transportWasOpen=!1,this._transport=null,this._transportId=0,this._deviceWentOffline=!1,this._transportClosed=!0,this._codec=new ve,this._reconnecting=!1,this._reconnectTimeout=null,this._reconnectAttempts=0,this._client=null,this._session="",this._node="",this._subs={},this._serverSubs={},this._commandId=0,this._commands=[],this._batching=!1,this._refreshRequired=!1,this._refreshTimeout=null,this._callbacks={},this._token="",this._data=null,this._dispatchPromise=Promise.resolve(),this._serverPing=0,this._serverPingTimeout=null,this._sendPong=!1,this._promises={},this._promiseId=0,this._debugEnabled=!1,this._networkEventsSet=!1,this._config={...Di,...r},this._configure(),this._debugEnabled?(this.on("state",i=>{this._debug("client state",i.oldState,"->",i.newState)}),this.on("error",i=>{this._debug("client error",i)})):this.on("error",function(){Function.prototype()})}newSubscription(e,r){if(this.getSubscription(e)!==null)throw new Error("Subscription to the channel "+e+" already exists");let i=new Be(this,e,r);return this._subs[e]=i,i}getSubscription(e){return this._getSub(e)}removeSubscription(e){e&&(e.state!=="unsubscribed"&&e.unsubscribe(),this._removeSubscription(e))}subscriptions(){return this._subs}ready(e){return this.state==="disconnected"?Promise.reject({code:3,message:"client disconnected"}):this.state==="connected"?Promise.resolve():new Promise((r,i)=>{let s={resolve:r,reject:i};e&&(s.timeout=setTimeout(function(){i({code:1,message:"timeout"})},e)),this._promises[this._nextPromiseId()]=s})}connect(){if(this._isConnected()){this._debug("connect called when already connected");return}if(this._isConnecting()){this._debug("connect called when already connecting");return}this._debug("connect called"),this._reconnectAttempts=0,this._startConnecting()}disconnect(){this._disconnect(0,"disconnect called",!1)}setToken(e){this._token=e}setHeaders(e){this._config.headers=e}send(e){let r={send:{data:e}},i=this;return this._methodCall().then(function(){return i._transportSendCommands([r])?Promise.resolve():Promise.reject(i._createErrorObject(10,"transport write error"))})}rpc(e,r){let i={rpc:{method:e,data:r}},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(o){return{data:o.rpc.data}})})}publish(e,r){let i={publish:{channel:e,data:r}},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(){return{}})})}history(e,r){let i={history:this._getHistoryRequest(e,r)},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(o){let a=o.history,u=[];if(a.publications)for(let c=0;c<a.publications.length;c++)u.push(s._getPublicationContext(e,a.publications[c]));return{publications:u,epoch:a.epoch||"",offset:a.offset||0}})})}presence(e){let r={presence:{channel:e}},i=this;return this._methodCall().then(function(){return i._callPromise(r,function(s){let o=s.presence.presence;for(let a in o)if(o.hasOwnProperty(a)){let u=o[a].conn_info,c=o[a].chan_info;u&&(o[a].connInfo=u),c&&(o[a].chanInfo=c)}return{clients:o}})})}presenceStats(e){let r={presence_stats:{channel:e}},i=this;return this._methodCall().then(function(){return i._callPromise(r,function(s){let o=s.presence_stats;return{numUsers:o.num_users,numClients:o.num_clients}})})}startBatching(){this._batching=!0}stopBatching(){let e=this;Promise.resolve().then(function(){Promise.resolve().then(function(){e._batching=!1,e._flush()})})}_debug(...e){this._debugEnabled&&Sr("debug",e)}_formatOverride(){}_configure(){if(!("Promise"in globalThis))throw new Error("Promise polyfill required");if(!this._endpoint)throw new Error("endpoint configuration required");if(this._config.token!==null&&(this._token=this._config.token),this._config.data!==null&&(this._data=this._config.data),this._codec=new ve,this._formatOverride(),(this._config.debug===!0||typeof localStorage<"u"&&localStorage.getItem("centrifuge.debug"))&&(this._debugEnabled=!0),this._debug("config",this._config),typeof this._endpoint!="string")if(typeof this._endpoint=="object"&&this._endpoint instanceof Array){this._transports=this._endpoint,this._emulation=!0;for(let e in this._transports)if(this._transports.hasOwnProperty(e)){let r=this._transports[e];if(!r.endpoint||!r.transport)throw new Error("malformed transport configuration");let i=r.transport;if(["websocket","http_stream","sse","sockjs","webtransport"].indexOf(i)<0)throw new Error("unsupported transport name: "+i)}}else throw new Error("unsupported url configuration type: only string or array of objects are supported")}_setState(e){if(this.state!==e){this._reconnecting=!1;let r=this.state;return this.state=e,this.emit("state",{newState:e,oldState:r}),!0}return!1}_isDisconnected(){return this.state==="disconnected"}_isConnecting(){return this.state==="connecting"}_isConnected(){return this.state==="connected"}_nextCommandId(){return++this._commandId}_setNetworkEvents(){if(this._networkEventsSet)return;let e=null;this._config.networkEventTarget!==null?e=this._config.networkEventTarget:typeof globalThis.addEventListener<"u"&&(e=globalThis),e&&(e.addEventListener("offline",()=>{this._debug("offline event triggered"),(this.state==="connected"||this.state==="connecting")&&(this._disconnect(1,"transport closed",!0),this._deviceWentOffline=!0)}),e.addEventListener("online",()=>{this._debug("online event triggered"),this.state==="connecting"&&(this._deviceWentOffline&&!this._transportClosed&&(this._deviceWentOffline=!1,this._transportClosed=!0),this._clearReconnectTimeout(),this._startReconnecting())}),this._networkEventsSet=!0)}_getReconnectDelay(){let e=le(this._reconnectAttempts,this._config.minReconnectDelay,this._config.maxReconnectDelay);return this._reconnectAttempts+=1,e}_clearOutgoingRequests(){for(let e in this._callbacks)if(this._callbacks.hasOwnProperty(e)){let r=this._callbacks[e];clearTimeout(r.timeout);let i=r.errback;if(!i)continue;i({error:this._createErrorObject(11,"connection closed")})}this._callbacks={}}_clearConnectedState(){this._client=null,this._clearServerPingTimeout(),this._clearRefreshTimeout();for(let e in this._subs){if(!this._subs.hasOwnProperty(e))continue;let r=this._subs[e];r.state==="subscribed"&&r._setSubscribing(1,"transport closed")}for(let e in this._serverSubs)this._serverSubs.hasOwnProperty(e)&&this.emit("subscribing",{channel:e})}_handleWriteError(e){for(let r of e){let i=r.id;if(!(i in this._callbacks))continue;let s=this._callbacks[i];clearTimeout(this._callbacks[i].timeout),delete this._callbacks[i];let o=s.errback;o({error:this._createErrorObject(10,"transport write error")})}}_transportSendCommands(e){if(!e.length)return!0;if(!this._transport)return!1;try{this._transport.send(this._codec.encodeCommands(e),this._session,this._node)}catch(r){return this._debug("error writing commands",r),this._handleWriteError(e),!1}return!0}_initializeTransport(){let e;this._config.websocket!==null?e=this._config.websocket:typeof globalThis.WebSocket!="function"&&typeof globalThis.WebSocket!="object"||(e=globalThis.WebSocket);let r=null;this._config.sockjs!==null?r=this._config.sockjs:typeof globalThis.SockJS<"u"&&(r=globalThis.SockJS);let i=null;this._config.eventsource!==null?i=this._config.eventsource:typeof globalThis.EventSource<"u"&&(i=globalThis.EventSource);let s=null;this._config.fetch!==null?s=this._config.fetch:typeof globalThis.fetch<"u"&&(s=globalThis.fetch);let o=null;if(this._config.readableStream!==null?o=this._config.readableStream:typeof globalThis.ReadableStream<"u"&&(o=globalThis.ReadableStream),this._emulation){this._currentTransportIndex>=this._transports.length&&(this._triedAllTransports=!0,this._currentTransportIndex=0);let f=0;for(;;){if(f>=this._transports.length)throw new Error("no supported transport found");let y=this._transports[this._currentTransportIndex],v=y.transport,w=y.endpoint;if(v==="websocket"){if(this._debug("trying websocket transport"),this._transport=new be(w,{websocket:e}),!this._transport.supported()){this._debug("websocket transport not available"),this._currentTransportIndex++,f++;continue}}else if(v==="webtransport"){if(this._debug("trying webtransport transport"),this._transport=new Me(w,{webtransport:globalThis.WebTransport,decoder:this._codec,encoder:this._codec}),!this._transport.supported()){this._debug("webtransport transport not available"),this._currentTransportIndex++,f++;continue}}else if(v==="http_stream"){if(this._debug("trying http_stream transport"),this._transport=new Fe(w,{fetch:s,readableStream:o,emulationEndpoint:this._config.emulationEndpoint,decoder:this._codec,encoder:this._codec}),!this._transport.supported()){this._debug("http_stream transport not available"),this._currentTransportIndex++,f++;continue}}else if(v==="sse"){if(this._debug("trying sse transport"),this._transport=new Je(w,{eventsource:i,fetch:s,emulationEndpoint:this._config.emulationEndpoint}),!this._transport.supported()){this._debug("sse transport not available"),this._currentTransportIndex++,f++;continue}}else if(v==="sockjs"){if(this._debug("trying sockjs"),this._transport=new je(w,{sockjs:r,sockjsOptions:this._config.sockjsOptions}),!this._transport.supported()){this._debug("sockjs transport not available"),this._currentTransportIndex++,f++;continue}}else throw new Error("unknown transport "+v);break}}else{if(wr(this._endpoint,"http"))throw new Error("Provide explicit transport endpoints configuration in case of using HTTP (i.e. using array of TransportEndpoint instead of a single string), or use ws(s):// scheme in an endpoint if you aimed using WebSocket transport");if(this._debug("client will use websocket"),this._transport=new be(this._endpoint,{websocket:e}),!this._transport.supported())throw new Error("WebSocket constructor not found, make sure it is available globally or passed as a dependency in Centrifuge options")}let a=this,u=this._transport,c=this._nextTransportId();a._debug("id of transport",c);let l=!1,b=[];if(this._transport.emulation()){let f=a._sendConnect(!0);b.push(f)}this._setNetworkEvents();let x=this._codec.encodeCommands(b);this._transportClosed=!1;let p;p=setTimeout(function(){u.close()},this._config.timeout),this._transport.initialize(this._codec.name(),{onOpen:function(){if(p&&(clearTimeout(p),p=null),a._transportId!=c){a._debug("open callback from non-actual transport"),u.close();return}l=!0,a._debug(u.subName(),"transport open"),!u.emulation()&&(a._transportIsOpen=!0,a._transportWasOpen=!0,a.startBatching(),a._sendConnect(!1),a._sendSubscribeCommands(),a.stopBatching(),a.emit("__centrifuge_debug:connect_frame_sent",{}))},onError:function(f){if(a._transportId!=c){a._debug("error callback from non-actual transport");return}a._debug("transport level error",f)},onClose:function(f){if(p&&(clearTimeout(p),p=null),a._transportId!=c){a._debug("close callback from non-actual transport");return}a._debug(u.subName(),"transport closed"),a._transportClosed=!0,a._transportIsOpen=!1;let y="connection closed",v=!0,w=0;if(f&&"code"in f&&f.code&&(w=f.code),f&&f.reason)try{let ge=JSON.parse(f.reason);y=ge.reason,v=ge.reconnect}catch{y=f.reason,(w>=3500&&w<4e3||w>=4500&&w<5e3)&&(v=!1)}w<3e3?(w===1009?(w=3,y="message size limit exceeded",v=!1):(w=1,y="transport closed"),a._emulation&&!a._transportWasOpen&&(a._currentTransportIndex++,a._currentTransportIndex>=a._transports.length&&(a._triedAllTransports=!0,a._currentTransportIndex=0))):a._transportWasOpen=!0,a._isConnecting()&&!l&&a.emit("error",{type:"transport",error:{code:2,message:"transport closed"},transport:u.name()}),a._reconnecting=!1,a._disconnect(w,y,v)},onMessage:function(f){a._dataReceived(f)}},x),a.emit("__centrifuge_debug:transport_initialized",{})}_sendConnect(e){let r=this._constructConnectCommand(),i=this;return this._call(r,e).then(s=>{let o=s.reply.connect;i._connectResponse(o),s.next&&s.next()},s=>{i._connectError(s.error),s.next&&s.next()}),r}_startReconnecting(){if(this._debug("start reconnecting"),!this._isConnecting()){this._debug("stop reconnecting: client not in connecting state");return}if(this._reconnecting){this._debug("reconnect already in progress, return from reconnect routine");return}if(this._transportClosed===!1){this._debug("waiting for transport close");return}this._reconnecting=!0;let e=this._token==="";if(!(this._refreshRequired||e&&this._config.getToken!==null)){this._config.getData?this._config.getData().then(s=>{this._isConnecting()&&(this._data=s,this._initializeTransport())}).catch(s=>this._handleGetDataError(s)):this._initializeTransport();return}let i=this;this._getToken().then(function(s){if(i._isConnecting()){if(s==null||s==null){i._failUnauthorized();return}i._token=s,i._debug("connection token refreshed"),i._config.getData?i._config.getData().then(function(o){i._isConnecting()&&(i._data=o,i._initializeTransport())}).catch(o=>i._handleGetDataError(o)):i._initializeTransport()}}).catch(function(s){if(!i._isConnecting())return;if(s instanceof N){i._failUnauthorized();return}i.emit("error",{type:"connectToken",error:{code:5,message:s!==void 0?s.toString():""}});let o=i._getReconnectDelay();i._debug("error on getting connection token, reconnect after "+o+" milliseconds",s),i._reconnecting=!1,i._reconnectTimeout=setTimeout(()=>{i._startReconnecting()},o)})}_handleGetDataError(e){if(e instanceof N){this._failUnauthorized();return}this.emit("error",{type:"connectData",error:{code:12,message:e?.toString()||""}});let r=this._getReconnectDelay();this._debug("error on getting connect data, reconnect after "+r+" milliseconds",e),this._reconnecting=!1,this._reconnectTimeout=setTimeout(()=>{this._startReconnecting()},r)}_connectError(e){this.state==="connecting"&&(e.code===109&&(this._refreshRequired=!0),e.code<100||e.temporary===!0||e.code===109?(this.emit("error",{type:"connect",error:e}),this._debug("closing transport due to connect error"),this._disconnect(e.code,e.message,!0)):this._disconnect(e.code,e.message,!1))}_scheduleReconnect(){if(!this._isConnecting())return;let e=!1;this._emulation&&!this._transportWasOpen&&!this._triedAllTransports&&(e=!0);let r=this._getReconnectDelay();e&&(r=0),this._debug("reconnect after "+r+" milliseconds"),this._clearReconnectTimeout(),this._reconnectTimeout=setTimeout(()=>{this._startReconnecting()},r)}_constructConnectCommand(){let e={};this._token&&(e.token=this._token),this._data&&(e.data=this._data),this._config.name&&(e.name=this._config.name),this._config.version&&(e.version=this._config.version),Object.keys(this._config.headers).length>0&&(e.headers=this._config.headers);let r={},i=!1;for(let s in this._serverSubs)if(this._serverSubs.hasOwnProperty(s)&&this._serverSubs[s].recoverable){i=!0;let o={recover:!0};this._serverSubs[s].offset&&(o.offset=this._serverSubs[s].offset),this._serverSubs[s].epoch&&(o.epoch=this._serverSubs[s].epoch),r[s]=o}return i&&(e.subs=r),{connect:e}}_getHistoryRequest(e,r){let i={channel:e};return r!==void 0&&(r.since&&(i.since={offset:r.since.offset},r.since.epoch&&(i.since.epoch=r.since.epoch)),r.limit!==void 0&&(i.limit=r.limit),r.reverse===!0&&(i.reverse=!0)),i}_methodCall(){return this._isConnected()?Promise.resolve():new Promise((e,r)=>{let i=setTimeout(function(){r({code:1,message:"timeout"})},this._config.timeout);this._promises[this._nextPromiseId()]={timeout:i,resolve:e,reject:r}})}_callPromise(e,r){return new Promise((i,s)=>{this._call(e,!1).then(o=>{i(r(o.reply)),o.next&&o.next()},o=>{s(o.error),o.next&&o.next()})})}_dataReceived(e){this._serverPing>0&&this._waitServerPing();let r=this._codec.decodeReplies(e);this._dispatchPromise=this._dispatchPromise.then(()=>{let i;this._dispatchPromise=new Promise(s=>{i=s}),this._dispatchSynchronized(r,i)})}_dispatchSynchronized(e,r){let i=Promise.resolve();for(let s in e)e.hasOwnProperty(s)&&(i=i.then(()=>this._dispatchReply(e[s])));i=i.then(()=>{r()})}_dispatchReply(e){let r,i=new Promise(o=>{r=o});if(e==null)return this._debug("dispatch: got undefined or null reply"),r(),i;let s=e.id;return s&&s>0?this._handleReply(e,r):e.push?this._handlePush(e.push,r):this._handleServerPing(r),i}_call(e,r){return new Promise((i,s)=>{e.id=this._nextCommandId(),this._registerCall(e.id,i,s),r||this._addCommand(e)})}_startConnecting(){this._debug("start connecting"),this._setState("connecting")&&this.emit("connecting",{code:0,reason:"connect called"}),this._client=null,this._startReconnecting()}_disconnect(e,r,i){if(this._isDisconnected())return;this._transportIsOpen=!1;let s=this.state;this._reconnecting=!1;let o={code:e,reason:r},a=!1;if(i?a=this._setState("connecting"):(a=this._setState("disconnected"),this._rejectPromises({code:3,message:"disconnected"})),this._clearOutgoingRequests(),s==="connecting"&&this._clearReconnectTimeout(),s==="connected"&&this._clearConnectedState(),a&&(this._isConnecting()?this.emit("connecting",o):this.emit("disconnected",o)),this._transport){this._debug("closing existing transport");let u=this._transport;this._transport=null,u.close(),this._transportClosed=!0,this._nextTransportId()}else this._debug("no transport to close");this._scheduleReconnect()}_failUnauthorized(){this._disconnect(1,"unauthorized",!1)}_getToken(){return this._debug("get connection token"),this._config.getToken?this._config.getToken({}):(this.emit("error",{type:"configuration",error:{code:12,message:"token expired but no getToken function set in the configuration"}}),Promise.reject(new N("")))}_refresh(){let e=this._client,r=this;this._getToken().then(function(i){if(e!==r._client)return;if(!i){r._failUnauthorized();return}if(r._token=i,r._debug("connection token refreshed"),!r._isConnected())return;let s={refresh:{token:r._token}};r._call(s,!1).then(o=>{let a=o.reply.refresh;r._refreshResponse(a),o.next&&o.next()},o=>{r._refreshError(o.error),o.next&&o.next()})}).catch(function(i){if(r._isConnected()){if(i instanceof N){r._failUnauthorized();return}r.emit("error",{type:"refreshToken",error:{code:6,message:i!==void 0?i.toString():""}}),r._refreshTimeout=setTimeout(()=>r._refresh(),r._getRefreshRetryDelay())}})}_refreshError(e){e.code<100||e.temporary===!0?(this.emit("error",{type:"refresh",error:e}),this._refreshTimeout=setTimeout(()=>this._refresh(),this._getRefreshRetryDelay())):this._disconnect(e.code,e.message,!1)}_getRefreshRetryDelay(){return le(0,5e3,1e4)}_refreshResponse(e){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),e.expires&&(this._client=e.client,this._refreshTimeout=setTimeout(()=>this._refresh(),he(e.ttl)))}_removeSubscription(e){e!==null&&delete this._subs[e.channel]}_unsubscribe(e){if(!this._transportIsOpen)return Promise.resolve();let i={unsubscribe:{channel:e.channel}},s=this;return new Promise((a,u)=>{this._call(i,!1).then(c=>{a(),c.next&&c.next()},c=>{a(),c.next&&c.next(),s._disconnect(4,"unsubscribe error",!0)})})}_getSub(e){let r=this._subs[e];return r||null}_isServerSub(e){return this._serverSubs[e]!==void 0}_sendSubscribeCommands(){let e=[];for(let r in this._subs){if(!this._subs.hasOwnProperty(r))continue;let i=this._subs[r];if(i._inflight!==!0&&i.state==="subscribing"){let s=i._subscribe();s&&e.push(s)}}return e}_connectResponse(e){if(this._transportIsOpen=!0,this._transportWasOpen=!0,this._reconnectAttempts=0,this._refreshRequired=!1,this._isConnected())return;this._client=e.client,this._setState("connected"),this._refreshTimeout&&clearTimeout(this._refreshTimeout),e.expires&&(this._refreshTimeout=setTimeout(()=>this._refresh(),he(e.ttl))),this._session=e.session,this._node=e.node,this.startBatching(),this._sendSubscribeCommands(),this.stopBatching();let r={client:e.client,transport:this._transport.subName()};e.data&&(r.data=e.data),this.emit("connected",r),this._resolvePromises(),this._processServerSubs(e.subs||{}),e.ping&&e.ping>0?(this._serverPing=e.ping*1e3,this._sendPong=e.pong===!0,this._waitServerPing()):this._serverPing=0}_processServerSubs(e){for(let r in e){if(!e.hasOwnProperty(r))continue;let i=e[r];this._serverSubs[r]={offset:i.offset,epoch:i.epoch,recoverable:i.recoverable||!1};let s=this._getSubscribeContext(r,i);this.emit("subscribed",s)}for(let r in e){if(!e.hasOwnProperty(r))continue;let i=e[r];if(i.recovered){let s=i.publications;if(s&&s.length>0)for(let o in s)s.hasOwnProperty(o)&&this._handlePublication(r,s[o])}}for(let r in this._serverSubs)this._serverSubs.hasOwnProperty(r)&&(e[r]||(this.emit("unsubscribed",{channel:r}),delete this._serverSubs[r]))}_clearRefreshTimeout(){this._refreshTimeout!==null&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearReconnectTimeout(){this._reconnectTimeout!==null&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null)}_clearServerPingTimeout(){this._serverPingTimeout!==null&&(clearTimeout(this._serverPingTimeout),this._serverPingTimeout=null)}_waitServerPing(){this._config.maxServerPingDelay!==0&&this._isConnected()&&(this._clearServerPingTimeout(),this._serverPingTimeout=setTimeout(()=>{this._isConnected()&&this._disconnect(2,"no ping",!0)},this._serverPing+this._config.maxServerPingDelay))}_getSubscribeContext(e,r){let i={channel:e,positioned:!1,recoverable:!1,wasRecovering:!1,recovered:!1};r.recovered&&(i.recovered=!0),r.positioned&&(i.positioned=!0),r.recoverable&&(i.recoverable=!0),r.was_recovering&&(i.wasRecovering=!0);let s="";"epoch"in r&&(s=r.epoch);let o=0;return"offset"in r&&(o=r.offset),(i.positioned||i.recoverable)&&(i.streamPosition={offset:o,epoch:s}),r.data&&(i.data=r.data),i}_handleReply(e,r){let i=e.id;if(!(i in this._callbacks)){r();return}let s=this._callbacks[i];if(clearTimeout(this._callbacks[i].timeout),delete this._callbacks[i],xr(e)){let o=s.errback;if(!o){r();return}let a=e.error;o({error:a,next:r})}else{let o=s.callback;if(!o)return;o({reply:e,next:r})}}_handleJoin(e,r){let i=this._getSub(e);if(!i){if(this._isServerSub(e)){let s={channel:e,info:this._getJoinLeaveContext(r.info)};this.emit("join",s)}return}i._handleJoin(r)}_handleLeave(e,r){let i=this._getSub(e);if(!i){if(this._isServerSub(e)){let s={channel:e,info:this._getJoinLeaveContext(r.info)};this.emit("leave",s)}return}i._handleLeave(r)}_handleUnsubscribe(e,r){let i=this._getSub(e);if(!i){this._isServerSub(e)&&(delete this._serverSubs[e],this.emit("unsubscribed",{channel:e}));return}r.code<2500?i._setUnsubscribed(r.code,r.reason,!1):i._setSubscribing(r.code,r.reason)}_handleSubscribe(e,r){this._serverSubs[e]={offset:r.offset,epoch:r.epoch,recoverable:r.recoverable||!1},this.emit("subscribed",this._getSubscribeContext(e,r))}_handleDisconnect(e){let r=e.code,i=!0;(r>=3500&&r<4e3||r>=4500&&r<5e3)&&(i=!1),this._disconnect(r,e.reason,i)}_getPublicationContext(e,r){let i={channel:e,data:r.data};return r.offset&&(i.offset=r.offset),r.info&&(i.info=this._getJoinLeaveContext(r.info)),r.tags&&(i.tags=r.tags),i}_getJoinLeaveContext(e){let r={client:e.client,user:e.user};return e.conn_info&&(r.connInfo=e.conn_info),e.chan_info&&(r.chanInfo=e.chan_info),r}_handlePublication(e,r){let i=this._getSub(e);if(!i){if(this._isServerSub(e)){let s=this._getPublicationContext(e,r);this.emit("publication",s),r.offset!==void 0&&(this._serverSubs[e].offset=r.offset)}return}i._handlePublication(r)}_handleMessage(e){this.emit("message",{data:e.data})}_handleServerPing(e){if(this._sendPong){let r={};this._transportSendCommands([r])}e()}_handlePush(e,r){let i=e.channel;e.pub?this._handlePublication(i,e.pub):e.message?this._handleMessage(e.message):e.join?this._handleJoin(i,e.join):e.leave?this._handleLeave(i,e.leave):e.unsubscribe?this._handleUnsubscribe(i,e.unsubscribe):e.subscribe?this._handleSubscribe(i,e.subscribe):e.disconnect&&this._handleDisconnect(e.disconnect),r()}_flush(){let e=this._commands.slice(0);this._commands=[],this._transportSendCommands(e)}_createErrorObject(e,r,i){let s={code:e,message:r};return i&&(s.temporary=!0),s}_registerCall(e,r,i){this._callbacks[e]={callback:r,errback:i,timeout:null},this._callbacks[e].timeout=setTimeout(()=>{delete this._callbacks[e],dt(i)&&i({error:this._createErrorObject(1,"timeout")})},this._config.timeout)}_addCommand(e){this._batching?this._commands.push(e):this._transportSendCommands([e])}_nextPromiseId(){return++this._promiseId}_nextTransportId(){return++this._transportId}_resolvePromises(){for(let e in this._promises)this._promises.hasOwnProperty(e)&&(this._promises[e].timeout&&clearTimeout(this._promises[e].timeout),this._promises[e].resolve(),delete this._promises[e])}_rejectPromises(e){for(let r in this._promises)this._promises.hasOwnProperty(r)&&(this._promises[r].timeout&&clearTimeout(this._promises[r].timeout),this._promises[r].reject(e),delete this._promises[r])}};ne.SubscriptionState=Ie;ne.State=Le;ne.UnauthorizedError=N;var re=lt(hi());var cr={};bi(cr,{default:()=>Os,nested:()=>xs});var xs={centrifugal:{nested:{centrifuge:{nested:{protocol:{options:{go_package:"./;protocol"},nested:{Error:{fields:{code:{type:"uint32",id:1},message:{type:"string",id:2},temporary:{type:"bool",id:3}}},EmulationRequest:{fields:{node:{type:"string",id:1},session:{type:"string",id:2},data:{type:"bytes",id:3}}},Command:{fields:{id:{type:"uint32",id:1},connect:{type:"ConnectRequest",id:4},subscribe:{type:"SubscribeRequest",id:5},unsubscribe:{type:"UnsubscribeRequest",id:6},publish:{type:"PublishRequest",id:7},presence:{type:"PresenceRequest",id:8},presence_stats:{type:"PresenceStatsRequest",id:9},history:{type:"HistoryRequest",id:10},ping:{type:"PingRequest",id:11},send:{type:"SendRequest",id:12},rpc:{type:"RPCRequest",id:13},refresh:{type:"RefreshRequest",id:14},sub_refresh:{type:"SubRefreshRequest",id:15}},reserved:[[2,2],[3,3]]},Reply:{fields:{id:{type:"uint32",id:1},error:{type:"Error",id:2},push:{type:"Push",id:4},connect:{type:"ConnectResult",id:5},subscribe:{type:"SubscribeResult",id:6},unsubscribe:{type:"UnsubscribeResult",id:7},publish:{type:"PublishResult",id:8},presence:{type:"PresenceResult",id:9},presence_stats:{type:"PresenceStatsResult",id:10},history:{type:"HistoryResult",id:11},ping:{type:"PingResult",id:12},rpc:{type:"RPCResult",id:13},refresh:{type:"RefreshResult",id:14},sub_refresh:{type:"SubRefreshResult",id:15}},reserved:[[3,3]]},Push:{fields:{channel:{type:"string",id:2},pub:{type:"Publication",id:4},join:{type:"Join",id:5},leave:{type:"Leave",id:6},unsubscribe:{type:"Unsubscribe",id:7},message:{type:"Message",id:8},subscribe:{type:"Subscribe",id:9},connect:{type:"Connect",id:10},disconnect:{type:"Disconnect",id:11},refresh:{type:"Refresh",id:12}},reserved:[[1,1],[3,3]]},ClientInfo:{fields:{user:{type:"string",id:1},client:{type:"string",id:2},conn_info:{type:"bytes",id:3},chan_info:{type:"bytes",id:4}}},Publication:{fields:{data:{type:"bytes",id:4},info:{type:"ClientInfo",id:5},offset:{type:"uint64",id:6},tags:{keyType:"string",type:"string",id:7},delta:{type:"bool",id:8},time:{type:"int64",id:9},channel:{type:"string",id:10}},reserved:[[1,1],[2,2],[3,3]]},Join:{fields:{info:{type:"ClientInfo",id:1}}},Leave:{fields:{info:{type:"ClientInfo",id:1}}},Unsubscribe:{fields:{code:{type:"uint32",id:2},reason:{type:"string",id:3}},reserved:[[1,1]]},Subscribe:{fields:{recoverable:{type:"bool",id:1},epoch:{type:"string",id:4},offset:{type:"uint64",id:5},positioned:{type:"bool",id:6},data:{type:"bytes",id:7}},reserved:[[2,2],[3,3]]},Message:{fields:{data:{type:"bytes",id:1}}},Connect:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},data:{type:"bytes",id:3},subs:{keyType:"string",type:"SubscribeResult",id:4},expires:{type:"bool",id:5},ttl:{type:"uint32",id:6},ping:{type:"uint32",id:7},pong:{type:"bool",id:8},session:{type:"string",id:9},node:{type:"string",id:10},time:{type:"int64",id:11}}},Disconnect:{fields:{code:{type:"uint32",id:1},reason:{type:"string",id:2},reconnect:{type:"bool",id:3}}},Refresh:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2}}},ConnectRequest:{fields:{token:{type:"string",id:1},data:{type:"bytes",id:2},subs:{keyType:"string",type:"SubscribeRequest",id:3},name:{type:"string",id:4},version:{type:"string",id:5},headers:{keyType:"string",type:"string",id:6}}},ConnectResult:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},expires:{type:"bool",id:3},ttl:{type:"uint32",id:4},data:{type:"bytes",id:5},subs:{keyType:"string",type:"SubscribeResult",id:6},ping:{type:"uint32",id:7},pong:{type:"bool",id:8},session:{type:"string",id:9},node:{type:"string",id:10},time:{type:"int64",id:11}}},RefreshRequest:{fields:{token:{type:"string",id:1}}},RefreshResult:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},expires:{type:"bool",id:3},ttl:{type:"uint32",id:4}}},SubscribeRequest:{fields:{channel:{type:"string",id:1},token:{type:"string",id:2},recover:{type:"bool",id:3},epoch:{type:"string",id:6},offset:{type:"uint64",id:7},data:{type:"bytes",id:8},positioned:{type:"bool",id:9},recoverable:{type:"bool",id:10},join_leave:{type:"bool",id:11},delta:{type:"string",id:12}},reserved:[[4,4],[5,5]]},SubscribeResult:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2},recoverable:{type:"bool",id:3},epoch:{type:"string",id:6},publications:{rule:"repeated",type:"Publication",id:7},recovered:{type:"bool",id:8},offset:{type:"uint64",id:9},positioned:{type:"bool",id:10},data:{type:"bytes",id:11},was_recovering:{type:"bool",id:12},delta:{type:"bool",id:13}},reserved:[[4,4],[5,5]]},SubRefreshRequest:{fields:{channel:{type:"string",id:1},token:{type:"string",id:2}}},SubRefreshResult:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2}}},UnsubscribeRequest:{fields:{channel:{type:"string",id:1}}},UnsubscribeResult:{fields:{}},PublishRequest:{fields:{channel:{type:"string",id:1},data:{type:"bytes",id:2}}},PublishResult:{fields:{}},PresenceRequest:{fields:{channel:{type:"string",id:1}}},PresenceResult:{fields:{presence:{keyType:"string",type:"ClientInfo",id:1}}},PresenceStatsRequest:{fields:{channel:{type:"string",id:1}}},PresenceStatsResult:{fields:{num_clients:{type:"uint32",id:1},num_users:{type:"uint32",id:2}}},StreamPosition:{fields:{offset:{type:"uint64",id:1},epoch:{type:"string",id:2}}},HistoryRequest:{fields:{channel:{type:"string",id:1},limit:{type:"int32",id:7},since:{type:"StreamPosition",id:8},reverse:{type:"bool",id:9}},reserved:[[2,2],[3,3],[4,4],[5,5],[6,6]]},HistoryResult:{fields:{publications:{rule:"repeated",type:"Publication",id:1},epoch:{type:"string",id:2},offset:{type:"uint64",id:3}}},PingRequest:{fields:{}},PingResult:{fields:{}},RPCRequest:{fields:{data:{type:"bytes",id:1},method:{type:"string",id:2}}},RPCResult:{fields:{data:{type:"bytes",id:1}}},SendRequest:{fields:{data:{type:"bytes",id:1}}}}}}}}}},Os={nested:xs};var lr=re.Root.fromJSON(cr),Es=lr.lookupType("protocol.Command"),di=lr.lookupType("protocol.Reply"),Ts=lr.lookupType("protocol.EmulationRequest"),at=class{name(){return"protobuf"}encodeEmulationRequest(t){let e=re.Writer.create();return Ts.encode(t,e),e.finish()}encodeCommands(t){let e=re.Writer.create();for(let r in t)if(t.hasOwnProperty(r)){let i=Object.assign({},t[r]);Es.encodeDelimited(i,e)}return e.finish()}decodeReplies(t){let e=[],r=re.Reader.create(new Uint8Array(t));for(;r.pos<r.len;){let i=di.decodeDelimited(r);e.push(i)}return e}decodeReply(t){let e=re.Reader.create(new Uint8Array(t));for(;e.pos<e.len;)return di.decodeDelimited(e),{ok:!0,pos:e.pos};return{ok:!1}}applyDeltaIfNeeded(t,e){let r,i;if(t.delta){let s=Ue(e,t.data);r=new Uint8Array(s),i=s}else r=t.data,i=t.data;return{newData:r,newPrevValue:i}}};var ut=class extends ne{_formatOverride(){this._codec=new at}};globalThis.Centrifuge=ut;})();
//# sourceMappingURL=centrifuge.protobuf.js.map
